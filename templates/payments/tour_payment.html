{% load static humanize %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="csrf-token" content="{{ csrf_token }}" />
  <meta name="theme-color" content="#008000" />
  <title>Secure Payment - Airport & Destinations</title>

  <!-- Tailwind CSS v3 -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- FontAwesome 6.4.0 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <!-- Google Fonts: Poppins, Montserrat & Playfair Display -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@700;800;900&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet" />

  <style>
    :root {
      /* Safari/Travel Theme Colors */
      --safari-gold: #c6a350;
      --safari-dark: #2b2a28;
      --safari-light: #f8f7f3;
      --safari-accent: #8b7355;
      --safari-green: #2e7d32;
      --safari-cream: #f5f1e6;
      --safari-brown: #795548;
      --safari-orange: #e65100;
      --safari-sand: #f5e9c8;
      --kenya-green: #008000; /* Green from Kenyan flag */
      --kenya-black: #000000; /* Black from Kenyan flag */
      --kenya-red: #CE1126; /* Red from Kenyan flag */

      /* Glassmorphism */
      --glass-bg: rgba(255, 255, 255, 0.15);
      --glass-border: rgba(255, 255, 255, 0.2);
      --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
      --glass-blur: 8px;

      /* Original Colors */
      --primary: #2563eb;
      --primary-dark: #1d4ed8;
      --secondary: #f59e0b;
      --dark: #1e293b;
      --light: #f8fafc;
      --gray: #64748b;
      --light-gray: #e2e8f0;
      --success: #10b981;
      --error: #ef4444;
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --rounded-sm: 0.25rem;
      --rounded: 0.5rem;
      --rounded-lg: 0.75rem;
      --transition: all 0.3s ease;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      font-family: 'Poppins', sans-serif;
      line-height: 1.6;
      color: var(--safari-dark);
      background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)),
                  url('https://www.tripsavvy.com/thmb/KkQlX5E5LN1pLgpQtu_7ooUgg4s=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/GettyImages-468020303-593ea6513df78c537b17ce38.jpg');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      position: relative;
      width: 100%;
      overflow-x: hidden;
    }

    /* Safari pattern overlay */
    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23c6a350' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      opacity: 0.3;
      z-index: -1;
      pointer-events: none;
    }

    .container {
      width: 100%;
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 2rem;
    }

    /* Header Styles */
    .header {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      box-shadow: var(--glass-shadow);
      border-bottom: 1px solid var(--glass-border);
      position: sticky;
      top: 0;
      z-index: 300;
      padding: 1rem 0;
      width: 100%;
    }

    .header .container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .brand a {
      font-family: 'Playfair Display', serif;
      font-weight: 700;
      font-size: clamp(1.2rem, 3vw, 1.5rem);
      color: var(--safari-gold);
      text-decoration: none;
      display: flex;
      align-items: center;
      transition: var(--transition);
    }

    .brand a:hover {
      transform: translateY(-2px);
    }

    .brand i {
      font-size: clamp(1.5rem, 3vw, 1.75rem);
      color: var(--safari-gold);
    }

    .nav {
      display: flex;
      gap: 1.5rem;
      align-items: center;
    }

    .nav a {
      color: white;
      text-decoration: none;
      font-weight: 500;
      padding: 0.5rem 0;
      position: relative;
      transition: var(--transition);
      font-size: clamp(0.9rem, 1.2vw, 1rem);
    }

    .nav a:hover {
      color: var(--safari-gold);
    }

    .nav a::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 0;
      height: 2px;
      background-color: var(--safari-gold);
      transition: var(--transition);
    }

    .nav a:hover::after {
      width: 100%;
    }

    .nav .btn {
      background: var(--kenya-green);
      color: white;
      border-radius: var(--rounded);
      padding: 0.5rem 1rem;
      font-weight: 500;
      transition: var(--transition);
      border: 1px solid var(--kenya-green);
    }

    .nav .btn:hover {
      background: var(--safari-gold);
      color: var(--kenya-black);
      border-color: var(--safari-gold);
    }

    .mobile-menu-btn {
      display: none;
      background: var(--kenya-green);
      border: 1px solid var(--kenya-green);
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      width: 45px;
      height: 45px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--glass-shadow);
      transition: var(--transition);
    }

    .mobile-menu-btn:hover {
      background: var(--safari-gold);
      color: var(--kenya-black);
    }

    /* Hero Section */
    .hero {
      color: white;
      text-align: center;
      padding: clamp(3rem, 10vw, 5rem) 1.5rem;
      border-radius: var(--rounded-lg);
      margin: 2rem 0;
      position: relative;
      overflow: hidden;
      width: 100%;
    }

    .hero::before {
      content: "";
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 100px;
      background: linear-gradient(to top, rgba(0, 0, 0, 0.7), transparent);
    }

    .hero h1 {
      font-family: 'Playfair Display', serif;
      font-size: clamp(1.8rem, 5vw, 2.8rem);
      margin-bottom: 1rem;
      line-height: 1.2;
      text-shadow: 0 2px 4px rgba(0,0,0,0.5);
    }

    .hero p {
      font-size: clamp(1rem, 2vw, 1.25rem);
      max-width: 800px;
      margin: 0 auto 2rem;
      text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    }

    /* Cards Section */
    .card {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border: 1px solid var(--glass-border);
      border-radius: var(--rounded-lg);
      box-shadow: var(--glass-shadow);
      transition: var(--transition);
      display: flex;
      flex-direction: column;
      height: 100%;
      overflow: hidden;
      position: relative;
    }

    .card:hover {
      transform: translateY(-10px);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.2);
    }

    .card-content {
      padding: 1.5rem;
      flex: 1;
      display: flex;
      flex-direction: column;
      background: rgba(0, 0, 0, 0.6);
    }

    /* Buttons */
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      background: var(--kenya-green);
      color: white;
      border-radius: var(--rounded);
      font-weight: 600;
      text-decoration: none;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--kenya-green);
    }

    .btn:hover {
      background: var(--safari-gold);
      color: var(--kenya-black);
      transform: translateY(-3px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }

    .btn i {
      transition: transform 0.3s ease;
    }

    .btn:hover i {
      transform: translateX(3px);
    }

    /* Form input styles */
    .input-field {
      width: 100%;
      padding: 14px 16px;
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      font-size: 16px;
      transition: all 0.3s ease;
      background: rgba(255, 255, 255, 0.1);
      color: white;
    }

    .input-field::placeholder {
      color: rgba(255, 255, 255, 0.6);
    }

    .input-field:focus {
      outline: none;
      border-color: var(--safari-gold);
      box-shadow: 0 0 0 3px rgba(198, 163, 80, 0.3);
    }

    /* Section title */
    .section-title {
      font-size: 1.8rem;
      font-weight: 700;
      color: white;
      margin-bottom: 1.25rem;
      display: flex;
      align-items: center;
      gap: 10px;
      font-family: 'Playfair Display', serif;
    }

    .section-title i {
      color: var(--safari-gold);
      font-size: 1.5rem;
    }

    /* Order summary */
    .order-summary {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border: 1px solid var(--glass-border);
      border-radius: var(--rounded-lg);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .order-line {
      display: flex;
      justify-content: space-between;
      padding: 0.5rem 0;
      color: white;
    }

    .order-line .label {
      color: rgba(255, 255, 255, 0.8);
      font-weight: 500;
    }

    .order-line .value {
      font-weight: 600;
      color: white;
    }

    .order-total {
      border-top: 1px solid rgba(255, 255, 255, 0.2);
      padding-top: 1rem;
      margin-top: 1rem;
    }

    .order-total .value {
      color: var(--safari-gold);
      font-size: 1.5rem;
      font-weight: 700;
    }

    /* Security badge */
    .security-badge {
      display: flex;
      align-items: center;
      gap: 8px;
      background: rgba(0, 128, 0, 0.2);
      padding: 8px 16px;
      border-radius: 24px;
      font-size: 0.875rem;
      color: white;
      backdrop-filter: blur(10px);
    }

    .security-badge i {
      color: var(--safari-gold);
    }

    /* Payment container */
    .payment-container {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border: 1px solid var(--glass-border);
      border-radius: var(--rounded-lg);
      padding: 1.5rem;
      position: relative;
      overflow: hidden;
    }

    /* Payment status */
    .payment-status {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 1rem;
      font-weight: 500;
      color: white;
    }

    .payment-status.success {
      background-color: rgba(16, 185, 129, 0.2);
      border: 1px solid rgba(16, 185, 129, 0.3);
    }

    .payment-status.error {
      background-color: rgba(239, 68, 68, 0.2);
      border: 1px solid rgba(239, 68, 68, 0.3);
    }

    .payment-status.processing {
      background-color: rgba(243, 156, 18, 0.2);
      border: 1px solid rgba(243, 156, 18, 0.3);
    }

    /* Progress bar */
    .progress-bar {
      height: 6px;
      background-color: rgba(255, 255, 255, 0.2);
      border-radius: 3px;
      overflow: hidden;
      margin-top: 1rem;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--kenya-green), var(--safari-gold));
      border-radius: 3px;
      width: 0%;
      transition: width 0.3s ease;
    }

    /* Payment processing overlay */
    .payment-processing {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      backdrop-filter: blur(5px);
    }

    .processing-content {
      text-align: center;
      max-width: 500px;
      padding: 1.5rem;
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      border-radius: var(--rounded-lg);
      border: 1px solid var(--glass-border);
    }

    .processing-spinner {
      width: 60px;
      height: 60px;
      border: 6px solid rgba(255, 255, 255, 0.2);
      border-top: 6px solid var(--safari-gold);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 1.5rem;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Toast notification */
    .toast-notification {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 12px 20px;
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      border: 1px solid var(--glass-border);
      border-radius: 10px;
      box-shadow: var(--glass-shadow);
      display: flex;
      align-items: center;
      gap: 10px;
      z-index: 1000;
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s ease;
      max-width: 350px;
      color: white;
    }

    .toast-notification.show {
      transform: translateY(0);
      opacity: 1;
    }

    .toast-notification.success {
      border-left: 4px solid var(--success);
    }

    .toast-notification.error {
      border-left: 4px solid var(--error);
    }

    .toast-icon {
      font-size: 20px;
    }

    .toast-notification.success .toast-icon {
      color: var(--success);
    }

    .toast-notification.error .toast-icon {
      color: var(--error);
    }

    /* Promo code section */
    .promo-code-section {
      margin-bottom: 1.5rem;
    }

    .promo-code-input-group {
      display: flex;
      gap: 0.5rem;
    }

    .promo-code-input {
      flex: 1;
      padding: 12px 16px;
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 10px 0 0 10px;
      font-size: 16px;
      transition: all 0.3s ease;
      background: rgba(255, 255, 255, 0.1);
      color: white;
    }

    .promo-code-input::placeholder {
      color: rgba(255, 255, 255, 0.6);
    }

    .promo-code-input:focus {
      outline: none;
      border-color: var(--safari-gold);
    }

    .promo-code-btn {
      padding: 12px 20px;
      background: var(--kenya-green);
      color: white;
      border: none;
      border-radius: 0 10px 10px 0;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .promo-code-btn:hover {
      background: var(--safari-gold);
      color: var(--kenya-black);
    }

    /* Security features */
    .security-features {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .security-feature {
      display: flex;
      align-items: center;
      padding: 0.75rem;
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      border-radius: 10px;
      box-shadow: var(--glass-shadow);
      border: 1px solid var(--glass-border);
    }

    .security-icon {
      width: 36px;
      height: 36px;
      border-radius: 8px;
      background: rgba(198, 163, 80, 0.2);
      color: var(--safari-gold);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 0.75rem;
    }

    .security-info {
      display: flex;
      flex-direction: column;
    }

    .security-title {
      font-weight: 600;
      font-size: 0.875rem;
      color: white;
    }

    .security-desc {
      font-size: 0.75rem;
      color: rgba(255, 255, 255, 0.8);
    }

    /* Countdown */
    .countdown {
      background: rgba(0, 128, 0, 0.2);
      padding: 8px 16px;
      border-radius: 24px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
      color: white;
    }

    .countdown::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(198, 163, 80, 0.2), transparent);
      animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    /* Tour details card */
    .tour-details-card {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border: 1px solid var(--glass-border);
      border-radius: var(--rounded-lg);
      overflow: hidden;
      box-shadow: var(--glass-shadow);
      margin-bottom: 1.5rem;
    }

    .tour-details-header {
      background: linear-gradient(135deg, var(--kenya-green) 0%, var(--safari-green) 100%);
      padding: 1.5rem;
      color: white;
      position: relative;
    }

    .tour-details-header::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      opacity: 0.2;
    }

    .tour-details-title {
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      font-family: 'Playfair Display', serif;
      position: relative;
      z-index: 1;
    }

    .tour-details-subtitle {
      font-size: 0.9rem;
      opacity: 0.9;
      position: relative;
      z-index: 1;
    }

    .tour-details-content {
      padding: 1.5rem;
      background: rgba(0, 0, 0, 0.6);
    }

    .tour-details-item {
      display: flex;
      justify-content: space-between;
      padding: 0.75rem 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      color: white;
    }

    .tour-details-item:last-child {
      border-bottom: none;
    }

    .tour-details-label {
      color: rgba(255, 255, 255, 0.8);
      font-weight: 500;
    }

    .tour-details-value {
      font-weight: 600;
      color: white;
    }

    /* Support card */
    .support-card {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border: 1px solid var(--glass-border);
      border-radius: var(--rounded-lg);
      overflow: hidden;
      box-shadow: var(--glass-shadow);
      margin-bottom: 1.5rem;
    }

    .support-header {
      background: linear-gradient(135deg, var(--safari-orange) 0%, var(--safari-brown) 100%);
      padding: 1.5rem;
      color: white;
    }

    .support-title {
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      font-family: 'Playfair Display', serif;
    }

    .support-content {
      padding: 1.5rem;
      background: rgba(0, 0, 0, 0.6);
    }

    .support-item {
      display: flex;
      align-items: center;
      padding: 0.75rem;
      border-radius: 8px;
      margin-bottom: 0.75rem;
      transition: all 0.3s ease;
      color: white;
    }

    .support-item:hover {
      background: rgba(198, 163, 80, 0.1);
    }

    .support-icon {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      background: rgba(230, 81, 0, 0.2);
      color: var(--safari-orange);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 1rem;
    }

    .support-text {
      color: white;
      font-weight: 500;
    }

    /* Security card */
    .security-card {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border: 1px solid var(--glass-border);
      border-radius: var(--rounded-lg);
      overflow: hidden;
      box-shadow: var(--glass-shadow);
    }

    .security-header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      padding: 1.5rem;
      color: white;
    }

    .security-title {
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      font-family: 'Playfair Display', serif;
    }

    .security-content {
      padding: 1.5rem;
      background: rgba(0, 0, 0, 0.6);
    }

    .security-item {
      display: flex;
      align-items: center;
      padding: 0.75rem;
      border-radius: 8px;
      margin-bottom: 0.75rem;
      transition: all 0.3s ease;
    }

    .security-item:hover {
      background: rgba(198, 163, 80, 0.1);
    }

    .security-item-icon {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      background: rgba(37, 99, 235, 0.2);
      color: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 1rem;
    }

    .security-item-content {
      flex: 1;
    }

    .security-item-title {
      font-weight: 600;
      color: white;
      margin-bottom: 0.25rem;
    }

    .security-item-desc {
      font-size: 0.875rem;
      color: rgba(255, 255, 255, 0.8);
    }

    /* Tour cards */
    .tour-card {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border: 1px solid var(--glass-border);
      border-radius: var(--rounded-lg);
      overflow: hidden;
      box-shadow: var(--glass-shadow);
      transition: var(--transition);
      height: 100%;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    .tour-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }

    .tour-image-container {
      position: relative;
      height: 180px;
      overflow: hidden;
    }

    .tour-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
    }

    .tour-card:hover .tour-image {
      transform: scale(1.05);
    }

    .tour-badge {
      position: absolute;
      top: 15px;
      right: 15px;
      background: var(--kenya-green);
      color: white;
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      z-index: 2;
    }

    .tour-badge.featured {
      background: var(--safari-gold);
      color: var(--kenya-black);
    }

    .tour-badge.new {
      background: var(--safari-green);
    }

    .tour-badge.discount {
      background: var(--kenya-red);
    }

    .tour-content {
      padding: 1.25rem;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      background: rgba(0, 0, 0, 0.6);
    }

    .tour-category {
      color: var(--safari-gold);
      font-size: 0.85rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }

    .tour-title {
      font-size: 1.125rem;
      font-weight: 700;
      color: white;
      margin-bottom: 0.5rem;
      line-height: 1.3;
      font-family: 'Playfair Display', serif;
    }

    .tour-description {
      color: rgba(255, 255, 255, 0.9);
      margin-bottom: 1rem;
      line-height: 1.6;
      flex-grow: 1;
    }

    .tour-highlights {
      margin-bottom: 1rem;
    }

    .tour-highlight {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.9);
    }

    .tour-highlight i {
      color: var(--safari-gold);
      margin-right: 8px;
      font-size: 0.8rem;
    }

    .tour-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .tour-price {
      color: var(--safari-gold);
      font-weight: 700;
      font-size: 1.125rem;
    }

    .tour-price .original-price {
      text-decoration: line-through;
      color: rgba(255, 255, 255, 0.7);
      font-size: 1rem;
      margin-right: 5px;
    }

    .tour-duration {
      display: flex;
      align-items: center;
      color: rgba(255, 255, 255, 0.9);
      font-size: 0.9rem;
    }

    .tour-duration i {
      margin-right: 5px;
      color: var(--safari-gold);
    }

    .tour-rating {
      display: flex;
      align-items: center;
      margin-bottom: 1rem;
    }

    .tour-rating i {
      color: var(--safari-gold);
      font-size: 0.9rem;
    }

    .tour-rating span {
      margin-left: 5px;
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.9);
    }

    .tour-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: auto;
    }

    .tour-ref {
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.8);
    }

    .btn-wishlist {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-wishlist:hover {
      background: rgba(198, 163, 80, 0.2);
      border-color: var(--safari-gold);
    }

    .btn-wishlist.active {
      background: var(--kenya-red);
      border-color: var(--kenya-red);
      color: white;
    }

    /* Form steps */
    .form-steps {
      display: flex;
      justify-content: space-between;
      margin-bottom: 2rem;
      position: relative;
    }

    .form-steps::before {
      content: "";
      position: absolute;
      top: 20px;
      left: 0;
      right: 0;
      height: 2px;
      background-color: rgba(255, 255, 255, 0.2);
      z-index: 1;
    }

    .form-step {
      position: relative;
      z-index: 2;
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100px;
    }

    .step-circle {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.2);
      color: rgba(255, 255, 255, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      margin-bottom: 0.5rem;
      transition: all 0.3s ease;
    }

    .form-step.active .step-circle {
      background-color: var(--safari-gold);
      color: var(--kenya-black);
    }

    .form-step.completed .step-circle {
      background-color: var(--kenya-green);
      color: white;
    }

    .step-label {
      font-size: 0.875rem;
      color: rgba(255, 255, 255, 0.8);
      text-align: center;
    }

    .form-step.active .step-label {
      color: white;
      font-weight: 600;
    }

    /* Paystack button */
    .paystack-button {
      background: linear-gradient(135deg, var(--kenya-green) 0%, var(--safari-green) 100%);
      color: white;
      font-weight: 600;
      padding: 16px 24px;
      border-radius: 12px;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      font-size: 18px;
      box-shadow: 0 4px 15px rgba(0, 128, 0, 0.3);
      position: relative;
      overflow: hidden;
      width: 100%;
    }

    .paystack-button::before {
      content: "";
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
    }

    .paystack-button:hover::before {
      left: 100%;
    }

    .paystack-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0, 128, 0, 0.4);
    }

    .paystack-button:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      transform: none;
    }

    /* Footer Styles */
    .footer {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border-top: 1px solid var(--glass-border);
      color: white;
      padding: 2rem 0;
      margin-top: auto;
      position: relative;
      width: 100%;
    }

    .footer::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: var(--safari-gold);
    }

    .footer .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
      position: relative;
      z-index: 1;
      width: 100%;
    }

    .footer p {
      color: rgba(255, 255, 255, 0.8);
      font-size: clamp(0.9rem, 1.5vw, 1rem);
    }

    .social-links {
      display: flex;
      gap: 1rem;
    }

    .social-link {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 2.5rem;
      height: 2.5rem;
      border-radius: 50%;
      background: var(--kenya-green);
      color: white;
      transition: var(--transition);
      border: 1px solid var(--kenya-green);
    }

    .social-link:hover {
      background: var(--safari-gold);
      color: var(--kenya-black);
      transform: translateY(-3px);
    }

    /* Mobile Styles */
    @media (max-width: 768px) {
      .container {
        padding: 0 1rem;
      }

      .nav {
        position: fixed;
        top: 75px;
        left: 0;
        width: 100%;
        background: var(--glass-bg);
        backdrop-filter: blur(var(--glass-blur));
        -webkit-backdrop-filter: blur(var(--glass-blur));
        border: 1px solid var(--glass-border);
        flex-direction: column;
        gap: 0;
        padding: 1rem 0;
        box-shadow: var(--glass-shadow);
        border-radius: 0 0 1rem 1rem;
        transform: translateY(-150%);
        transition: var(--transition);
        z-index: 99;
        max-height: calc(100vh - 75px);
        overflow-y: auto;
      }

      .nav.active {
        transform: translateY(0);
      }

      .nav a {
        width: 100%;
        padding: 1rem 1.5rem;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        align-items: center;
      }

      .nav a:hover {
        background: rgba(198, 163, 80, 0.1);
      }

      .nav a::after {
        display: none;
      }

      .nav .btn {
        margin: 1rem;
        width: calc(100% - 2rem);
        justify-content: center;
      }

      .mobile-menu-btn {
        display: flex;
      }

      .hero h1 {
        font-size: 2rem;
      }

      .hero p {
        font-size: 1.1rem;
      }

      .security-features {
        grid-template-columns: 1fr;
      }

      .form-steps {
        justify-content: space-around;
      }
    }

    /* Tablet Styles */
    @media (min-width: 769px) and (max-width: 1024px) {
      .security-features {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    /* Large Screens */
    @media (min-width: 1200px) {
      .container {
        padding: 0 2%;
      }
    }

    /* Extra Large Screens */
    @media (min-width: 1600px) {
      .container {
        max-width: 1600px;
      }
    }

    /* Accessibility */
    a:focus,
    button:focus,
    input:focus,
    textarea:focus {
      outline: 2px solid var(--safari-gold);
      outline-offset: 2px;
    }

    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card,
    .tour-card,
    .security-feature {
      animation: fadeIn 0.6s ease-out forwards;
    }

    .card:nth-child(2) { animation-delay: 0.1s; }
    .card:nth-child(3) { animation-delay: 0.2s; }
    .tour-card:nth-child(2) { animation-delay: 0.1s; }
    .tour-card:nth-child(3) { animation-delay: 0.2s; }
    .security-feature:nth-child(2) { animation-delay: 0.1s; }
    .security-feature:nth-child(3) { animation-delay: 0.2s; }
    .security-feature:nth-child(4) { animation-delay: 0.3s; }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="container">
      <div class="brand">
        <a href="/" aria-label="Home">
          <i class="fas fa-globe-africa" aria-hidden="true"></i>
          Airport & Destinations
        </a>
      </div>
      <nav class="nav" id="mainNav" aria-label="Main Navigation">
        <a href="{% url 'bookings:home' %}" aria-label="Home">
          <i class="fas fa-home"></i>
          Home
        </a>
        <a href="{% url 'bookings:tours' %}" aria-label="Tours">
          <i class="fas fa-binoculars"></i>
          Tours
        </a>
        <a href="{% url 'bookings:about' %}" aria-label="About">
          <i class="fas fa-info-circle"></i>
          About
        </a>
        <a href="{% url 'bookings:contact' %}" aria-label="Contact">
          <i class="fas fa-envelope"></i>
          Contact
        </a>
      </nav>
      <button class="mobile-menu-btn" id="menuToggle" aria-label="Toggle menu" aria-expanded="false" aria-controls="mainNav">
        <i class="fas fa-bars" aria-hidden="true"></i>
      </button>
    </div>
  </header>

  <!-- Main -->
  <main class="container">
    <section class="hero">
      <h1>Complete Your <span style="color: var(--safari-gold);">{{ tour.title }} Safari</span> Booking</h1>
      <p>Secure payment processing for your authentic Kenyan adventure</p>
    </section>

    <!-- Form Steps Progress -->
    <div class="form-steps mb-10">
      <div class="form-step active" id="step-1">
        <div class="step-circle">1</div>
        <div class="step-label">Traveler Info</div>
      </div>
      <div class="form-step" id="step-2">
        <div class="step-circle">2</div>
        <div class="step-label">Payment</div>
      </div>
      <div class="form-step" id="step-3">
        <div class="step-circle">3</div>
        <div class="step-label">Confirmation</div>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- Left Column: Payment Form -->
      <div class="lg:col-span-2">
        <!-- Guest Information -->
        <div id="guest-form" class="card mb-8 p-6 md:p-8">
          <h2 class="section-title">
            <i class="fas fa-user-circle"></i>
            Traveler Information
          </h2>
          <p class="text-white mb-6">Please provide your details to complete the booking</p>

          <form id="guest-info-form" method="POST" action="{% url 'bookings:tour_payment' tour.id %}">
            {% csrf_token %}

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
              <div>
                <label class="block text-white font-medium mb-2">Full Name *</label>
                <input type="text" id="full-name" name="full_name" required
                  class="input-field" placeholder="John Doe" />
                <span class="text-red-400 text-sm hidden" id="name-error">Please enter your full name</span>
              </div>
              <div>
                <label class="block text-white font-medium mb-2">Email Address *</label>
                <input type="email" id="guest-email" name="email" required
                  class="input-field" placeholder="john@example.com" />
                <span class="text-red-400 text-sm hidden" id="email-error">Please enter a valid email</span>
              </div>
            </div>

            <div class="mb-6">
              <label class="block text-white font-medium mb-2">Phone Number *</label>
              <div class="flex">
                <select id="country-code" name="country_code" class="input-field w-1/3 rounded-r-none">
                  <option value="+254">+254 (KE)</option>
                  <option value="+255">+255 (TZ)</option>
                  <option value="+256">+256 (UG)</option>
                </select>
                <input type="tel" id="phone" name="phone" required
                  class="input-field flex-1 rounded-l-none" placeholder="712 345 678" />
              </div>
              <span class="text-red-400 text-sm hidden" id="phone-error">Please enter a valid phone number</span>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
              <div>
                <label class="block text-white font-medium mb-2">Adults *</label>
                <input type="number" id="adults" name="adults" min="1" required
                  class="input-field" value="1" />
              </div>
              <div>
                <label class="block text-white font-medium mb-2">Children</label>
                <input type="number" id="children" name="children" min="0"
                  class="input-field" value="0" />
              </div>
              <div>
                <label class="block text-white font-medium mb-2">Days *</label>
                <input type="number" id="days" name="days" min="1"
                  class="input-field" value="{{ tour.duration_days }}" />
              </div>
            </div>

            <div class="mb-8">
              <label class="block text-white font-medium mb-2">Travel Date *</label>
              <input type="date" id="travel-date" name="travel_date" required
                min="{{ today|date:'Y-m-d' }}" class="input-field" />
              <span class="text-red-400 text-sm hidden" id="date-error">Please select a future date</span>
            </div>

            <button type="submit" id="continue-btn" class="btn w-full">
              <span>Continue to Payment</span>
              <i class="fas fa-arrow-right"></i>
            </button>
          </form>
        </div>

        <!-- Payment Section -->
        <div id="payment-section" class="card p-6 md:p-8 hidden">
          <h2 class="section-title">
            <i class="fas fa-credit-card"></i>
            Complete Your Payment
          </h2>

          <!-- Modern Guest Summary -->
          <div class="order-summary mb-8">
            <h3 class="text-xl font-semibold text-white mb-6 flex items-center">
              <i class="fas fa-receipt mr-3 text-yellow-400"></i> Booking Summary
            </h3>

            <div class="bg-black bg-opacity-30 rounded-xl p-6">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div class="flex items-center">
                  <div class="w-12 h-12 rounded-full bg-green-900 bg-opacity-30 flex items-center justify-center mr-4">
                    <i class="fas fa-user text-yellow-400"></i>
                  </div>
                  <div>
                    <p class="text-sm text-gray-300">Traveler</p>
                    <p class="font-medium text-white" id="summary-name">-</p>
                  </div>
                </div>

                <div class="flex items-center">
                  <div class="w-12 h-12 rounded-full bg-green-900 bg-opacity-30 flex items-center justify-center mr-4">
                    <i class="fas fa-envelope text-yellow-400"></i>
                  </div>
                  <div>
                    <p class="text-sm text-gray-300">Email</p>
                    <p class="font-medium text-white" id="summary-email">-</p>
                  </div>
                </div>

                <div class="flex items-center">
                  <div class="w-12 h-12 rounded-full bg-green-900 bg-opacity-30 flex items-center justify-center mr-4">
                    <i class="fas fa-phone text-yellow-400"></i>
                  </div>
                  <div>
                    <p class="text-sm text-gray-300">Phone</p>
                    <p class="font-medium text-white" id="summary-phone">-</p>
                  </div>
                </div>

                <div class="flex items-center">
                  <div class="w-12 h-12 rounded-full bg-green-900 bg-opacity-30 flex items-center justify-center mr-4">
                    <i class="fas fa-calendar text-yellow-400"></i>
                  </div>
                  <div>
                    <p class="text-sm text-gray-300">Travel Date</p>
                    <p class="font-medium text-white" id="summary-date">-</p>
                  </div>
                </div>

                <div class="flex items-center">
                  <div class="w-12 h-12 rounded-full bg-green-900 bg-opacity-30 flex items-center justify-center mr-4">
                    <i class="fas fa-users text-yellow-400"></i>
                  </div>
                  <div>
                    <p class="text-sm text-gray-300">Travelers</p>
                    <p class="font-medium text-white" id="summary-travelers">-</p>
                  </div>
                </div>

                <div class="flex items-center">
                  <div class="w-12 h-12 rounded-full bg-green-900 bg-opacity-30 flex items-center justify-center mr-4">
                    <i class="fas fa-clock text-yellow-400"></i>
                  </div>
                  <div>
                    <p class="text-sm text-gray-300">Duration</p>
                    <p class="font-medium text-white" id="summary-days">-</p>
                  </div>
                </div>
              </div>

              <div class="border-t border-gray-700 pt-6 mt-6">
                <div class="flex justify-between items-center mb-3">
                  <span class="text-gray-300">Adult Cost</span>
                  <span class="font-medium text-white" id="summary-adults-cost">-</span>
                </div>
                <div class="flex justify-between items-center mb-3">
                  <span class="text-gray-300">Children Cost</span>
                  <span class="font-medium text-white" id="summary-children-cost">-</span>
                </div>
                <div id="discount-row" class="flex justify-between items-center mb-3 hidden">
                  <span class="text-gray-300">Discount</span>
                  <span class="font-medium text-green-400" id="discount-amount">-</span>
                </div>
                <div class="flex justify-between items-center pt-4 mt-4 border-t border-gray-700">
                  <span class="text-lg font-bold text-white">Total Amount</span>
                  <span class="text-xl font-bold text-yellow-400" id="summary-total">-</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Promo Code Section -->
          <div class="promo-code-section mb-8">
            <h3 class="text-lg font-semibold text-white mb-4">Promo Code</h3>
            <div class="promo-code-input-group">
              <input type="text" id="promo-code" class="promo-code-input" placeholder="Enter promo code">
              <button type="button" id="apply-promo" class="promo-code-btn">Apply</button>
            </div>
            <div id="promo-message" class="mt-2 text-sm hidden"></div>
          </div>

          <!-- Payment Method Details -->
          <div class="mb-8">
            <h3 class="text-lg font-semibold text-white mb-4">Payment Method</h3>
            <div class="payment-method-card active bg-black bg-opacity-30 rounded-xl p-4">
              <div class="flex items-center justify-between">
                <div class="flex items-center">
                  <div class="w-14 h-14 rounded-xl bg-green-900 bg-opacity-30 flex items-center justify-center mr-4">
                    <i class="fas fa-credit-card text-yellow-400 text-2xl"></i>
                  </div>
                  <div>
                    <h4 class="font-semibold text-white text-lg">Paystack</h4>
                    <p class="text-sm text-gray-300">Secure online payment</p>
                  </div>
                </div>
                <div class="flex space-x-3">
                  <div class="w-12 h-8 bg-gray-800 rounded-lg flex items-center justify-center">
                    <i class="fab fa-cc-visa text-gray-300 text-xl"></i>
                  </div>
                  <div class="w-12 h-8 bg-gray-800 rounded-lg flex items-center justify-center">
                    <i class="fab fa-cc-mastercard text-gray-300 text-xl"></i>
                  </div>
                  <div class="w-12 h-8 bg-gray-800 rounded-lg flex items-center justify-center">
                    <i class="fab fa-cc-amex text-gray-300 text-xl"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Paystack Payment Container -->
          <div class="payment-container mb-8">
            <h3 class="text-lg font-semibold text-white mb-4">Enter Payment Details</h3>

            <!-- Payment Status -->
            <div class="payment-status processing" id="payment-status">
              <i class="fas fa-spinner fa-spin mr-2"></i>
              <span>Preparing secure payment...</span>
            </div>

            <div id="paystack-container">
              <!-- Loading state -->
              <div id="paystack-loading" class="flex flex-col items-center justify-center h-64">
                <div class="processing-spinner mb-4"></div>
                <p class="text-white font-medium">Initializing secure payment...</p>
                <p class="text-gray-300 text-sm mt-2">Please wait while we connect to Paystack</p>
                <div class="progress-bar w-full max-w-md mt-4">
                  <div class="progress-fill" id="progress-fill"></div>
                </div>
              </div>

              <!-- Paystack Payment Button (hidden initially) -->
              <div id="paystack-button-container" class="hidden">
                <button id="paystack-payment-button" class="paystack-button">
                  <i class="fas fa-lock"></i>
                  <span>Pay Securely with Paystack</span>
                  <span id="paystack-amount" class="font-bold"></span>
                </button>
              </div>

              <!-- Error state (hidden initially) -->
              <div id="paystack-error" class="hidden p-8 bg-red-900 bg-opacity-20 rounded-xl text-center">
                <div class="w-16 h-16 bg-red-900 bg-opacity-30 rounded-full flex items-center justify-center mx-auto mb-4">
                  <i class="fas fa-exclamation-triangle text-red-400 text-2xl"></i>
                </div>
                <h3 class="text-lg font-semibold text-red-300 mb-2">Payment Error</h3>
                <p class="text-red-200 mb-4">We couldn't initialize the payment. Please try again.</p>
                <button id="retry-payment" class="btn">
                  <span>Try Again</span>
                  <i class="fas fa-redo"></i>
                </button>
              </div>
            </div>
          </div>

          <!-- Security Features -->
          <div class="security-features mb-8">
            <div class="security-feature">
              <div class="security-icon">
                <i class="fas fa-shield-alt"></i>
              </div>
              <div class="security-info">
                <div class="security-title">SSL Encryption</div>
                <div class="security-desc">256-bit security</div>
              </div>
            </div>
            <div class="security-feature">
              <div class="security-icon">
                <i class="fas fa-lock"></i>
              </div>
              <div class="security-info">
                <div class="security-title">Data Protection</div>
                <div class="security-desc">PCI DSS compliant</div>
              </div>
            </div>
            <div class="security-feature">
              <div class="security-icon">
                <i class="fas fa-user-shield"></i>
              </div>
              <div class="security-info">
                <div class="security-title">Privacy</div>
                <div class="security-desc">Your data is safe</div>
              </div>
            </div>
            <div class="security-feature">
              <div class="security-icon">
                <i class="fas fa-money-check-alt"></i>
              </div>
              <div class="security-info">
                <div class="security-title">Refund Policy</div>
                <div class="security-desc">30-day guarantee</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Column: Tour Details -->
      <div class="lg:col-span-1">
        <!-- Tour Details Card -->
        <div class="tour-details-card">
          <div class="tour-details-header">
            <h3 class="tour-details-title">Tour Details</h3>
            <p class="tour-details-subtitle">{{ tour.title }}</p>
          </div>
          <div class="tour-details-content">
            <p class="text-gray-300 mb-4">{{ tour.description }}</p>
            <div class="tour-details-item">
              <span class="tour-details-label">Duration:</span>
              <span class="tour-details-value">{{ tour.duration_days }} days</span>
            </div>
            <div class="tour-details-item">
              <span class="tour-details-label">Price per person:</span>
              <span class="tour-details-value">KES {{ tour.price_per_person|floatformat:2|intcomma }}</span>
            </div>
            <div class="tour-details-item">
              <span class="tour-details-label">Category:</span>
              <span class="tour-details-value">{{ tour.category|title }}</span>
            </div>
            <div class="tour-details-item">
              <span class="tour-details-label">Booking Ref:</span>
              <span class="tour-details-value">AIRTOURS{{ tour.id|stringformat:"04d" }}/{% now "Y" %}</span>
            </div>
            <div class="mt-4">
              <h4 class="font-semibold text-white mb-2">What's Included</h4>
              <ul class="text-sm text-gray-300 space-y-1">
                {% for inclusion in tour.inclusions %}
                <li class="flex items-start">
                  <i class="fas fa-check text-yellow-400 mt-1 mr-2"></i>
                  <span>{{ inclusion }}</span>
                </li>
                {% empty %}
                <li class="flex items-start">
                  <i class="fas fa-check text-yellow-400 mt-1 mr-2"></i>
                  <span>Accommodation at the lodge</span>
                </li>
                <li class="flex items-start">
                  <i class="fas fa-check text-yellow-400 mt-1 mr-2"></i>
                  <span>All meals during the stay</span>
                </li>
                <li class="flex items-start">
                  <i class="fas fa-check text-yellow-400 mt-1 mr-2"></i>
                  <span>Game drives with experienced guides</span>
                </li>
                <li class="flex items-start">
                  <i class="fas fa-check text-yellow-400 mt-1 mr-2"></i>
                  <span>Park entrance fees</span>
                </li>
                {% endfor %}
              </ul>
            </div>
          </div>
        </div>

        <!-- Support Card -->
        <div class="support-card">
          <div class="support-header">
            <h3 class="support-title">Need Help?</h3>
          </div>
          <div class="support-content">
            <div class="support-item">
              <div class="support-icon">
                <i class="fas fa-phone-alt"></i>
              </div>
              <div class="support-text">Call us: +254 700 123456</div>
            </div>
            <div class="support-item">
              <div class="support-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="support-text">Email: info@airportanddestinations.com</div>
            </div>
            <div class="support-item">
              <div class="support-icon">
                <i class="fas fa-comments"></i>
              </div>
              <div class="support-text">Live Chat Available</div>
            </div>
          </div>
        </div>

        <!-- Security Card -->
        <div class="security-card">
          <div class="security-header">
            <h3 class="security-title">Security Guarantee</h3>
          </div>
          <div class="security-content">
            <div class="security-item">
              <div class="security-item-icon">
                <i class="fas fa-shield-alt"></i>
              </div>
              <div class="security-item-content">
                <div class="security-item-title">Secure Payments</div>
                <div class="security-item-desc">All transactions are encrypted</div>
              </div>
            </div>
            <div class="security-item">
              <div class="security-item-icon">
                <i class="fas fa-lock"></i>
              </div>
              <div class="security-item-content">
                <div class="security-item-title">Data Protection</div>
                <div class="security-item-desc">Your information is safe with us</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Other Tours Section -->
    <div class="mt-12">
      <h2 class="section-title">
        <i class="fas fa-map-marked-alt"></i>
        Other Popular Tours
      </h2>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        {% for other_tour in other_tours %}
        <!-- Tour Card -->
        <div class="tour-card">
          <div class="relative">
            {% if other_tour.get_image_src %}
              <img src="{{ other_tour.get_image_src }}" alt="{{ other_tour.title }}" class="tour-image">
            {% else %}
              <img src="{% static 'images/default-tour.jpg' %}" alt="{{ other_tour.title }}" class="tour-image">
            {% endif %}

            {% if other_tour.is_featured %}
            <span class="tour-badge featured">Featured</span>
            {% elif other_tour.is_new %}
            <span class="tour-badge new">New</span>
            {% elif other_tour.has_discount %}
            <span class="tour-badge discount">Sale</span>
            {% else %}
              {% if other_tour.price_per_person < 10000 %}
              <span class="tour-badge budget">Budget Friendly</span>
              {% elif other_tour.price_per_person < 25000 %}
              <span class="tour-badge value">Best Value</span>
              {% elif other_tour.price_per_person < 50000 %}
              <span class="tour-badge premium">Premium</span>
              {% else %}
              <span class="tour-badge luxury">Luxury</span>
              {% endif %}
            {% endif %}
          </div>
          <div class="tour-content">
            <div class="tour-category">{{ other_tour.category|title }}</div>
            <h3 class="tour-title">{{ other_tour.title }}</h3>
            <p class="tour-description">{{ other_tour.description|truncatewords:20 }}</p>

            <div class="tour-highlights">
              {% for highlight in other_tour.highlights|slice:":3" %}
              <div class="tour-highlight">
                <i class="fas fa-check"></i>
                <span>{{ highlight }}</span>
              </div>
              {% endfor %}
            </div>

            <div class="tour-rating">
              {% for i in "12345"|make_list %}
                {% if i <= other_tour.rating|default:4.5 %}
                  <i class="fas fa-star"></i>
                {% else %}
                  <i class="far fa-star"></i>
                {% endif %}
              {% endfor %}
              <span>({{ other_tour.reviews|default:24 }} reviews)</span>
            </div>

            <div class="tour-meta">
              <div class="tour-price">
                {% if other_tour.has_discount %}
                <span class="original-price">KES {{ other_tour.original_price|default:other_tour.price_per_person }}</span>
                KES {{ other_tour.price_per_person }}
                {% else %}
                KES {{ other_tour.price_per_person }}
                {% endif %}
              </div>
              <div class="tour-duration">
                <i class="fas fa-clock"></i>
                {{ other_tour.duration_days }} days
              </div>
            </div>

            <div class="tour-actions">
              <div class="tour-ref">
                <strong>Booking Ref:</strong>
                AIRTOURS{{ other_tour.id|stringformat:"04d" }}/{% now "Y" %}
              </div>
              <div>
                <button class="btn-wishlist" onclick="toggleWishlist(this, '{{ other_tour.id }}')" aria-label="Add to wishlist">
                  <i class="far fa-heart"></i>
                </button>
                <button class="btn" onclick="window.location.href='{% url 'bookings:tour_payment' other_tour.id %}'" aria-label="Book {{ other_tour.title }}">
                  Book Now <i class="fas fa-arrow-right"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
        {% empty %}
        <div class="col-span-2 text-center py-8">
          <i class="fas fa-map-marked-alt text-4xl text-gray-500 mb-4"></i>
          <h3 class="text-xl font-semibold text-gray-300 mb-2">No other tours available</h3>
          <p class="text-gray-400">Check back later for more safari adventures</p>
        </div>
        {% endfor %}
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <p> 2025 Airport & Destinations  DEV BRYTEC LTD  Nairobi, Kenya</p>
      <div class="social-links" role="navigation" aria-label="Social media">
        <a href="https://facebook.com" class="social-link" target="_blank" aria-label="Facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
        <a href="https://twitter.com" class="social-link" target="_blank" aria-label="Twitter">
          <i class="fab fa-twitter"></i>
        </a>
        <a href="https://instagram.com" class="social-link" target="_blank" aria-label="Instagram">
          <i class="fab fa-instagram"></i>
        </a>
        <a href="https://wa.me/254759234580" class="social-link" target="_blank" aria-label="WhatsApp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </div>
    </div>
  </footer>

  <!-- Payment Processing Overlay -->
  <div id="payment-processing" class="payment-processing hidden">
    <div class="processing-content">
      <div class="processing-spinner"></div>
      <h3 class="text-2xl font-bold text-white mb-2">Processing Your Payment</h3>
      <p class="text-gray-300 mb-6">Please wait while we initialize your secure payment with Paystack.</p>
      <div class="bg-black bg-opacity-30 p-4 rounded-lg text-left">
        <div class="flex items-center mb-3">
          <i class="fas fa-check-circle text-green-400 mr-2"></i>
          <span>Verifying your information</span>
        </div>
        <div class="flex items-center mb-3">
          <i class="fas fa-check-circle text-green-400 mr-2"></i>
          <span>Creating your booking</span>
        </div>
        <div class="flex items-center">
          <div class="w-5 h-5 rounded-full border-2 border-gray-300 mr-2"></div>
          <span>Initializing Paystack payment</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast Notification -->
  <div id="toast" class="toast-notification">
    <i class="toast-icon"></i>
    <div>
      <div class="toast-title font-medium"></div>
      <div class="toast-message text-sm text-gray-300"></div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://js.paystack.co/v1/inline.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Elements
      const guestForm = document.getElementById('guest-info-form');
      const continueBtn = document.getElementById('continue-btn');
      const paymentSection = document.getElementById('payment-section');
      const guestFormSection = document.getElementById('guest-form');
      const toast = document.getElementById('toast');
      const paystackLoading = document.getElementById('paystack-loading');
      const paystackButtonContainer = document.getElementById('paystack-button-container');
      const paystackError = document.getElementById('paystack-error');
      const retryPaymentBtn = document.getElementById('retry-payment');
      const paymentStatus = document.getElementById('payment-status');
      const progressFill = document.getElementById('progress-fill');
      const paystackPaymentButton = document.getElementById('paystack-payment-button');
      const paystackAmount = document.getElementById('paystack-amount');
      const menuToggle = document.getElementById('menuToggle');
      const mainNav = document.getElementById('mainNav');

      // Form steps
      const step1 = document.getElementById('step-1');
      const step2 = document.getElementById('step-2');
      const step3 = document.getElementById('step-3');

      // Promo code elements
      const promoCodeInput = document.getElementById('promo-code');
      const applyPromoBtn = document.getElementById('apply-promo');
      const promoMessage = document.getElementById('promo-message');
      const discountRow = document.getElementById('discount-row');
      const discountAmount = document.getElementById('discount-amount');

      // Form inputs
      const nameInput = document.getElementById('full-name');
      const emailInput = document.getElementById('guest-email');
      const phoneInput = document.getElementById('phone');
      const codeInput = document.getElementById('country-code');
      const adultsInput = document.getElementById('adults');
      const childrenInput = document.getElementById('children');
      const daysInput = document.getElementById('days');
      const travelDateInput = document.getElementById('travel-date');

      // Error elements
      const nameError = document.getElementById('name-error');
      const emailError = document.getElementById('email-error');
      const phoneError = document.getElementById('phone-error');
      const dateError = document.getElementById('date-error');

      // Summary elements
      const sName = document.getElementById('summary-name');
      const sEmail = document.getElementById('summary-email');
      const sPhone = document.getElementById('summary-phone');
      const sDate = document.getElementById('summary-date');
      const sTrav = document.getElementById('summary-travelers');
      const sDays = document.getElementById('summary-days');
      const sAdultsCost = document.getElementById('summary-adults-cost');
      const sChildrenCost = document.getElementById('summary-children-cost');
      const sTotal = document.getElementById('summary-total');

      // Pricing
      const pricePerPerson = Number('{{ tour.price_per_person|floatformat:2 }}');
      const durationDays = Number('{{ tour.duration_days }}');
      const dailyRate = durationDays > 0 ? (pricePerPerson / durationDays) : 0;

      // State variables
      let discountPercentage = 0;
      let discountCode = '';

      // Mobile menu toggle
      menuToggle.addEventListener('click', () => {
        const isOpen = mainNav.classList.toggle('active');
        menuToggle.setAttribute('aria-expanded', isOpen);

        // Toggle icon between bars and times
        const icon = menuToggle.querySelector('i');
        if (isOpen) {
          icon.classList.remove('fa-bars');
          icon.classList.add('fa-times');
        } else {
          icon.classList.remove('fa-times');
          icon.classList.add('fa-bars');
        }
      });

      // Close menu when clicking outside
      document.addEventListener('click', (e) => {
        if (!mainNav.contains(e.target) && !menuToggle.contains(e.target) && mainNav.classList.contains('active')) {
          mainNav.classList.remove('active');
          menuToggle.setAttribute('aria-expanded', false);

          // Reset icon
          const icon = menuToggle.querySelector('i');
          icon.classList.remove('fa-times');
          icon.classList.add('fa-bars');
        }
      });

      // Close menu when window is resized above mobile breakpoint
      window.addEventListener('resize', () => {
        if (window.innerWidth > 768) {
          mainNav.classList.remove('active');
          menuToggle.setAttribute('aria-expanded', false);

          // Reset icon
          const icon = menuToggle.querySelector('i');
          icon.classList.remove('fa-times');
          icon.classList.add('fa-bars');
        }
      });

      // Format currency
      function formatKES(amount) {
        try {
          return new Intl.NumberFormat('en-KE', {
            style: 'currency',
            currency: 'KES',
            minimumFractionDigits: 0
          }).format(Math.round(amount));
        } catch (e) {
          return `KES ${Math.round(amount).toLocaleString('en-KE')}`;
        }
      }

      // Calculate order summary
      function recalc() {
        const adults = Math.max(parseInt(adultsInput.value || '0', 10), 0);
        const children = Math.max(parseInt(childrenInput.value || '0', 10), 0);
        const days = Math.max(parseInt(daysInput.value || '0', 10), 0);

        // Pricing logic
        const firstAdultCost = adults >= 1 ? (dailyRate * days) : 0;
        const additionalAdultsCost = adults > 1 ? ((adults - 1) * dailyRate * 0.9 * days) : 0;
        const childrenCost = children * dailyRate * 0.5 * days;
        const adultsCost = firstAdultCost + additionalAdultsCost;
        const subtotal = adultsCost + childrenCost;

        // Apply discount if any
        const discountAmountValue = subtotal * (discountPercentage / 100);
        const total = subtotal - discountAmountValue;

        // Update summary
        sName.textContent = nameInput.value || '-';
        sEmail.textContent = emailInput.value || '-';
        sPhone.textContent = phoneInput.value ? `${codeInput.value} ${phoneInput.value}` : '-';
        sDate.textContent = travelDateInput.value || '-';
        sTrav.textContent = `${adults} Adults, ${children} Children`;
        sDays.textContent = `${days} Days`;
        sAdultsCost.textContent = formatKES(adultsCost);
        sChildrenCost.textContent = formatKES(childrenCost);
        sTotal.textContent = formatKES(total);

        // Show discount if applied
        if (discountPercentage > 0) {
          discountRow.classList.remove('hidden');
          discountAmount.textContent = `-${formatKES(discountAmountValue)}`;
        } else {
          discountRow.classList.add('hidden');
        }

        return total;
      }

      // Add input listeners
      [nameInput, emailInput, phoneInput, codeInput, adultsInput, childrenInput, daysInput, travelDateInput].forEach(el => {
        if (el) el.addEventListener('input', recalc);
      });

      // Promo code handling
      if (applyPromoBtn && promoCodeInput) {
        applyPromoBtn.addEventListener('click', () => {
          const code = promoCodeInput.value.trim().toUpperCase();

          // Simple validation - in a real app, this would be validated server-side
          if (code === 'SAFARI10') {
            discountPercentage = 10;
            discountCode = code;
            promoMessage.textContent = 'Promo code applied! 10% discount.';
            promoMessage.className = 'mt-2 text-sm text-green-400';
            promoMessage.classList.remove('hidden');
            applyPromoBtn.disabled = true;
            applyPromoBtn.textContent = 'Applied';
            recalc();
          } else if (code === 'WELCOME15') {
            discountPercentage = 15;
            discountCode = code;
            promoMessage.textContent = 'Promo code applied! 15% discount.';
            promoMessage.className = 'mt-2 text-sm text-green-400';
            promoMessage.classList.remove('hidden');
            applyPromoBtn.disabled = true;
            applyPromoBtn.textContent = 'Applied';
            recalc();
          } else if (code === '') {
            promoMessage.textContent = 'Please enter a promo code.';
            promoMessage.className = 'mt-2 text-sm text-red-400';
            promoMessage.classList.remove('hidden');
          } else {
            promoMessage.textContent = 'Invalid promo code.';
            promoMessage.className = 'mt-2 text-sm text-red-400';
            promoMessage.classList.remove('hidden');
          }
        });
      }

      // Function to initialize Paystack payment
      function initializePaystackPayment() {
        if (paystackLoading) {
          paystackLoading.classList.remove('hidden');
        }
        if (paystackButtonContainer) {
          paystackButtonContainer.classList.add('hidden');
        }
        if (paystackError) {
          paystackError.classList.add('hidden');
        }

        // Reset payment status
        if (paymentStatus) {
          paymentStatus.className = 'payment-status processing';
          paymentStatus.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i><span>Initializing secure payment...</span>';
        }

        // Simulate progress
        let progress = 0;
        const progressInterval = setInterval(() => {
          progress += 10;
          if (progressFill) {
            progressFill.style.width = `${progress}%`;
          }

          if (progress >= 100) {
            clearInterval(progressInterval);

            // After progress completes, show the Paystack button
            setTimeout(() => {
              if (paystackLoading) {
                paystackLoading.classList.add('hidden');
              }
              if (paystackButtonContainer) {
                paystackButtonContainer.classList.remove('hidden');
              }
              if (paymentStatus) {
                paymentStatus.className = 'payment-status success';
                paymentStatus.innerHTML = '<i class="fas fa-check-circle mr-2"></i><span>Ready for secure payment</span>';
              }
            }, 500);
          }
        }, 200);

        // Calculate the total amount
        const adults = parseInt(adultsInput.value || '0', 10);
        const children = parseInt(childrenInput.value || '0', 10);
        const days = parseInt(daysInput.value || '0', 10);

        // Pricing logic
        const firstAdultCost = adults >= 1 ? (dailyRate * days) : 0;
        const additionalAdultsCost = adults > 1 ? ((adults - 1) * dailyRate * 0.9 * days) : 0;
        const childrenCost = children * dailyRate * 0.5 * days;
        const adultsCost = firstAdultCost + additionalAdultsCost;
        const subtotal = adultsCost + childrenCost;

        // Apply discount if any
        const discountAmountValue = subtotal * (discountPercentage / 100);
        const total = subtotal - discountAmountValue;

        // Update Paystack button amount
        if (paystackAmount) {
          paystackAmount.textContent = formatKES(total);
        }

        // Set up Paystack payment handler
        if (paystackPaymentButton) {
          paystackPaymentButton.onclick = function() {
            const handler = PaystackPop.setup({
              key: '{{ public_key }}',
              email: emailInput.value,
              amount: total * 100, // Convert to kobo
              currency: 'KES',
              ref: `PAY-${Date.now()}-${Math.floor(Math.random() * 1000000000)}`,
              callback: function(response) {
                // Update form steps
                if (step2) step2.classList.add('completed');
                if (step3) step3.classList.add('active');

                // Redirect to verification page
                window.location.href = '{% url "bookings:paystack_callback" %}?reference=' + response.reference;
              },
              onClose: function() {
                showToast('info', 'Payment Cancelled', 'You have cancelled the payment process.');
              }
            });
            handler.openIframe();
          };
        }
      }

      // Form validation
      function validateForm() {
        let isValid = true;

        // Validate name
        if (!nameInput.value.trim()) {
          if (nameError) nameError.classList.remove('hidden');
          isValid = false;
        } else {
          if (nameError) nameError.classList.add('hidden');
        }

        // Validate email
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(emailInput.value)) {
          if (emailError) emailError.classList.remove('hidden');
          isValid = false;
        } else {
          if (emailError) emailError.classList.add('hidden');
        }

        // Validate phone
        if (!phoneInput.value.trim() || phoneInput.value.length < 6) {
          if (phoneError) phoneError.classList.remove('hidden');
          isValid = false;
        } else {
          if (phoneError) phoneError.classList.add('hidden');
        }

        // Validate date
        const selectedDate = new Date(travelDateInput.value);
        const today = new Date();
        today.setHours(0, 0, 0, 0);

        if (!travelDateInput.value || selectedDate < today) {
          if (dateError) dateError.classList.remove('hidden');
          isValid = false;
        } else {
          if (dateError) dateError.classList.add('hidden');
        }

        return isValid;
      }

      // Form submission handler
      if (guestForm) {
        guestForm.addEventListener('submit', (e) => {
          e.preventDefault();

          if (!validateForm()) {
            showToast('error', 'Validation Error', 'Please correct the errors in the form');
            return;
          }

          const adults = parseInt(adultsInput.value || '0', 10);
          if (adults < 1) {
            showToast('error', 'Validation Error', 'At least one adult is required');
            return;
          }

          if (continueBtn) {
            continueBtn.disabled = true;
            continueBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Processing...';
          }

          recalc();

          if (guestFormSection) {
            guestFormSection.classList.add('hidden');
          }
          if (paymentSection) {
            paymentSection.classList.remove('hidden');
          }

          // Update form steps
          if (step1) step1.classList.add('completed');
          if (step2) step2.classList.add('active');

          window.scrollTo({ top: 0, behavior: 'smooth' });

          setTimeout(() => {
            initializePaystackPayment();
            if (continueBtn) {
              continueBtn.disabled = false;
              continueBtn.innerHTML = '<span>Continue to Payment</span> <i class="fas fa-arrow-right"></i>';
            }
          }, 500);
        });
      }

      // Retry payment
      if (retryPaymentBtn) {
        retryPaymentBtn.addEventListener('click', () => {
          initializePaystackPayment();
        });
      }

      // Toast notification
      function showToast(type, title, message) {
        const toastEl = document.getElementById('toast');
        if (!toastEl) return;

        const toastIcon = toastEl.querySelector('.toast-icon');
        const toastTitle = toastEl.querySelector('.toast-title');
        const toastMessage = toastEl.querySelector('.toast-message');

        if (toastTitle) toastTitle.textContent = title;
        if (toastMessage) toastMessage.textContent = message;

        toastEl.className = 'toast-notification ' + type;
        if (toastIcon) {
          toastIcon.className = type === 'success' || type === 'info'
            ? 'toast-icon fas fa-check-circle'
            : 'toast-icon fas fa-exclamation-circle';
        }

        toastEl.classList.add('show');
        setTimeout(() => toastEl.classList.remove('show'), 5000);
      }

      // Initialize summary
      recalc();

      // Countdown timer
      let timeLeft = 15 * 60;
      const countdownElement = document.getElementById('countdown-timer');

      if (countdownElement) {
        const countdown = setInterval(() => {
          const minutes = Math.floor(timeLeft / 60);
          const seconds = timeLeft % 60;
          countdownElement.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

          if (timeLeft <= 0) {
            clearInterval(countdown);
            countdownElement.textContent = "Expired";

            // Show session expired message
            showToast('error', 'Session Expired', 'Your payment session has expired. Please refresh the page to start again.');

            // Disable form
            if (guestForm) {
              guestForm.querySelectorAll('input, button').forEach(el => {
                el.disabled = true;
              });
            }
          }
          timeLeft--;
        }, 1000);
      }
    });

    // Wishlist functionality
    function toggleWishlist(button, tourId) {
      const wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
      const index = wishlist.indexOf(tourId);

      if (index > -1) {
        // Remove from wishlist
        wishlist.splice(index, 1);
        button.classList.remove('active');
        button.innerHTML = '<i class="far fa-heart"></i>';
        showToast('info', 'Removed from wishlist', 'Tour removed from your wishlist');
      } else {
        // Add to wishlist
        wishlist.push(tourId);
        button.classList.add('active');
        button.innerHTML = '<i class="fas fa-heart"></i>';
        showToast('success', 'Added to wishlist', 'Tour added to your wishlist');
      }

      // Save to localStorage
      localStorage.setItem('wishlist', JSON.stringify(wishlist));
    }

    // Initialize wishlist state
    document.addEventListener('DOMContentLoaded', function() {
      const wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];

      wishlist.forEach(tourId => {
        const wishlistButton = document.querySelector(`.btn-wishlist[onclick*="${tourId}"]`);
        if (wishlistButton) {
          wishlistButton.classList.add('active');
          wishlistButton.innerHTML = '<i class="fas fa-heart"></i>';
        }
      });
    });
  </script>
</body>
</html>