<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="description" content="Experience authentic Kenyan safaris and premium airport transfers. Discover the magic of Africa with our expertly curated wildlife adventures."/>
  <meta name="keywords" content="Kenya Safaris, Nairobi Airport Transfers, Maasai Mara Tours, Amboseli Safaris, Kenyan Wildlife, African Adventure"/>
  <meta name="author" content="Airport & Destinations Kenya"/>
  <title>Book Online | Airport & Destinations</title>
  <meta data-whatsapp-number="254759234580">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@700;800;900&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    /* Safari Theme Colors */
    :root {
      /* Safari Theme Colors */
      --safari-gold: #c6a350;
      --safari-dark: #2b2a28;
      --safari-light: #f8f7f3;
      --safari-accent: #8b7355;
      --safari-green: #2e7d32;
      --safari-cream: #f5f1e6;
      --safari-brown: #795548;
      --safari-orange: #e65100;
      --safari-sand: #f5e9c8;
      --kenya-green: #008000;
      --kenya-black: #000000;
      --kenya-red: #CE1126;
      --kenya-white: #FFFFFF;

      /* Glassmorphism */
      --glass-bg: rgba(255, 255, 255, 0.15);
      --glass-border: rgba(255, 255, 255, 0.2);
      --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
      --glass-blur: 8px;

      /* Original Colors */
      --primary: #2563eb;
      --primary-dark: #1d4ed8;
      --secondary: #f59e0b;
      --dark: #1e293b;
      --light: #f8fafc;
      --gray: #64748b;
      --light-gray: #e2e8f0;
      --success: #10b981;
      --error: #ef4444;
      --whatsapp: #25D366;
      --whatsapp-dark: #128C7E;
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --rounded-sm: 0.25rem;
      --rounded: 0.5rem;
      --rounded-lg: 0.75rem;
      --rounded-xl: 1.5rem;
      --transition: all 0.3s ease;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      font-family: 'Poppins', sans-serif;
      line-height: 1.6;
      color: var(--safari-dark);
      background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)),
                  url('https://www.tripsavvy.com/thmb/KkQlX5E5LN1pLgpQtu_7ooUgg4s=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/GettyImages-468020303-593ea6513df78c537b17ce38.jpg');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      position: relative;
      width: 100%;
      overflow-x: hidden;
    }

    /* Safari pattern overlay */
    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23c6a350' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      opacity: 0.3;
      z-index: -1;
      pointer-events: none;
    }

    .container {
      width: 100%;
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 2rem;
    }

    /* Header Styles */
    .header {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      box-shadow: var(--glass-shadow);
      border-bottom: 1px solid var(--glass-border);
      position: sticky;
      top: 0;
      z-index: 300;
      padding: 1rem 0;
      width: 100%;
    }

    .header .container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .brand a {
      font-family: 'Playfair Display', serif;
      font-weight: 700;
      font-size: clamp(1.2rem, 3vw, 1.5rem);
      color: var(--safari-gold);
      text-decoration: none;
      display: flex;
      align-items: center;
      transition: var(--transition);
    }

    .brand a:hover {
      transform: translateY(-2px);
    }

    .brand i {
      font-size: clamp(1.5rem, 3vw, 1.75rem);
      color: var(--safari-gold);
    }

    .nav {
      display: flex;
      gap: 1.5rem;
      align-items: center;
    }

    .nav a {
      color: white;
      text-decoration: none;
      font-weight: 500;
      padding: 0.5rem 0;
      position: relative;
      transition: var(--transition);
      font-size: clamp(0.9rem, 1.2vw, 1rem);
    }

    .nav a:hover {
      color: var(--safari-gold);
    }

    .nav a::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 0;
      height: 2px;
      background-color: var(--safari-gold);
      transition: var(--transition);
    }

    .nav a:hover::after {
      width: 100%;
    }

    .nav .btn {
      background: var(--kenya-green);
      color: white;
      border-radius: var(--rounded);
      padding: 0.5rem 1rem;
      font-weight: 500;
      transition: var(--transition);
      border: 1px solid var(--kenya-green);
    }

    .nav .btn:hover {
      background: var(--safari-gold);
      color: var(--kenya-black);
      border-color: var(--safari-gold);
    }

    .mobile-menu-btn {
      display: none;
      background: var(--kenya-green);
      border: 1px solid var(--kenya-green);
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      width: 45px;
      height: 45px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--glass-shadow);
      transition: var(--transition);
    }

    .mobile-menu-btn:hover {
      background: var(--safari-gold);
      color: var(--kenya-black);
    }

    /* Main Content */
    main {
      flex: 1;
      padding: 2rem 0;
      width: 100%;
    }

    .booking-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0;
      display: flex;
      flex-direction: column;
      gap: 2.5rem;
    }

    .booking-header {
      text-align: center;
      margin-bottom: 1.5rem;
    }

    .booking-header h1 {
      font-family: 'Playfair Display', serif;
      font-size: clamp(2rem, 5vw, 3rem);
      color: white;
      margin-bottom: 1rem;
      text-shadow: 0 2px 4px rgba(0,0,0,0.5);
      position: relative;
      display: inline-block;
    }

    .booking-header h1::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 3px;
      background: linear-gradient(90deg, var(--kenya-green), var(--safari-gold), var(--kenya-red));
    }

    .booking-header p {
      font-size: clamp(1rem, 2vw, 1.25rem);
      color: rgba(255, 255, 255, 0.9);
      max-width: 800px;
      margin: 1.5rem auto 0;
      text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    }

    .booking-content {
      display: grid;
      grid-template-columns: 1fr;
      gap: 2.5rem;
    }

    .booking-illustration {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border: 1px solid var(--glass-border);
      border-radius: var(--rounded-lg);
      box-shadow: var(--glass-shadow);
      padding: 2.5rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
    }

    .booking-illustration:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.2);
    }

    .booking-illustration i {
      font-size: clamp(3rem, 5vw, 4.5rem);
      color: var(--safari-gold);
      margin-bottom: 1.5rem;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    .booking-illustration h2 {
      font-family: 'Playfair Display', serif;
      font-size: clamp(1.5rem, 3vw, 2.2rem);
      color: white;
      margin-bottom: 1rem;
    }

    .booking-illustration p {
      color: rgba(255, 255, 255, 0.9);
      max-width: 400px;
      margin: 0 auto;
      font-size: 1.1rem;
    }

    .form-container {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border: 1px solid var(--glass-border);
      border-radius: var(--rounded-lg);
      box-shadow: var(--glass-shadow);
      padding: 2.5rem;
      position: relative;
      overflow: hidden;
    }

    .form-container::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: linear-gradient(90deg, var(--kenya-green), var(--safari-gold), var(--kenya-red));
    }

    .form-container h2 {
      font-family: 'Playfair Display', serif;
      font-size: clamp(1.5rem, 3vw, 2.2rem);
      color: white;
      margin-bottom: 2rem;
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .form-container h2 i {
      color: var(--safari-gold);
    }

    .form-section {
      margin-bottom: 2.5rem;
    }

    .form-section-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.4rem;
      color: white;
      margin-bottom: 1.2rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      position: relative;
      padding-bottom: 0.5rem;
    }

    .form-section-title::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 60px;
      height: 2px;
      background: var(--safari-gold);
    }

    .form-section-title i {
      color: var(--safari-gold);
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    .form-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: white;
      font-size: 0.95rem;
    }

    .form-control {
      width: 100%;
      padding: 0.875rem 1rem;
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: var(--rounded);
      font-size: 1rem;
      transition: var(--transition);
      background: rgba(255, 255, 255, 0.1);
      color: white;
    }

    .form-control:focus {
      border-color: var(--safari-gold);
      outline: none;
      box-shadow: 0 0 0 3px rgba(198, 163, 80, 0.2);
    }

    .form-control::placeholder {
      color: rgba(255, 255, 255, 0.6);
    }

    select.form-control option {
      background: var(--safari-dark);
      color: white;
    }

    textarea.form-control {
      min-height: 100px;
      resize: vertical;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.75rem;
      margin-top: 2rem;
      padding: 1rem 2rem;
      background: var(--kenya-green);
      color: white;
      border: none;
      border-radius: var(--rounded-lg);
      font-weight: 600;
      font-size: 1.1rem;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--kenya-green);
      width: 100%;
      position: relative;
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.2);
      transition: var(--transition);
    }

    .btn:hover {
      background: var(--safari-gold);
      color: var(--kenya-black);
      transform: translateY(-3px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn i {
      font-size: 1.25rem;
      transition: transform 0.3s ease;
    }

    .btn:hover i {
      transform: translateX(3px);
    }

    .form-note {
      margin-top: 2rem;
      background: rgba(198, 163, 80, 0.1);
      padding: 1.5rem;
      border-radius: var(--rounded-lg);
      font-size: 0.95rem;
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      border-left: 4px solid var(--safari-gold);
    }

    .form-note i {
      color: var(--safari-gold);
      font-size: 1.25rem;
      margin-top: 0.25rem;
    }

    .form-note p {
      color: rgba(255, 255, 255, 0.9);
      line-height: 1.6;
    }

    .form-note strong {
      color: white;
    }

    /* Vehicle Selection Styles */
    .vehicle-selection {
      margin-bottom: 2rem;
    }

    .vehicle-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .vehicle-card {
      border: 1px solid var(--glass-border);
      border-radius: var(--rounded-lg);
      overflow: hidden;
      cursor: pointer;
      transition: all 0.3s ease;
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      box-shadow: var(--glass-shadow);
      position: relative;
      display: flex;
      flex-direction: column;
    }

    .vehicle-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: linear-gradient(90deg, var(--kenya-green), var(--safari-gold), var(--kenya-red));
      transform: scaleX(0);
      transform-origin: left;
      transition: transform 0.3s ease;
      z-index: 1;
    }

    .vehicle-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.2);
    }

    .vehicle-card:hover::before {
      transform: scaleX(1);
    }

    .vehicle-card.selected {
      border-color: var(--safari-gold);
      background: rgba(198, 163, 80, 0.1);
    }

    .vehicle-card.selected::before {
      transform: scaleX(1);
      background: var(--safari-gold);
    }

    .vehicle-image-container {
      width: 100%;
      height: 180px;
      overflow: hidden;
      position: relative;
      background-color: rgba(0, 0, 0, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .vehicle-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
    }

    .vehicle-card:hover .vehicle-image {
      transform: scale(1.05);
    }

    .no-image-placeholder {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      width: 100%;
      color: rgba(255, 255, 255, 0.7);
      background-color: rgba(0, 0, 0, 0.2);
    }

    .no-image-placeholder i {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
      color: var(--safari-gold);
    }

    .no-image-placeholder p {
      font-size: 0.9rem;
      text-align: center;
      padding: 0 1rem;
    }

    .vehicle-content {
      padding: 1.25rem;
      flex: 1;
      display: flex;
      flex-direction: column;
      background: rgba(0, 0, 0, 0.3);
    }

    .vehicle-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 0.75rem;
    }

    .vehicle-title {
      font-family: 'Montserrat', sans-serif;
      font-size: 1.15rem;
      font-weight: 700;
      color: white;
      margin: 0;
    }

    .vehicle-year {
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.7);
      margin-top: 0.15rem;
    }

    .vehicle-price {
      font-family: 'Montserrat', sans-serif;
      font-size: 1rem;
      font-weight: 700;
      color: var(--safari-gold);
      white-space: nowrap;
    }

    .vehicle-details {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      margin: 1rem 0;
    }

    .vehicle-detail {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.8);
    }

    .vehicle-detail i {
      color: var(--safari-gold);
      font-size: 0.85rem;
    }

    .vehicle-features {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: auto;
      padding-top: 1rem;
    }

    .vehicle-feature {
      background: rgba(198, 163, 80, 0.1);
      color: white;
      font-size: 0.75rem;
      padding: 0.25rem 0.6rem;
      border-radius: 20px;
      display: flex;
      align-items: center;
      gap: 0.3rem;
      font-weight: 500;
      transition: var(--transition);
    }

    .vehicle-feature:hover {
      background: rgba(198, 163, 80, 0.2);
      transform: translateY(-2px);
    }

    .vehicle-feature i {
      color: var(--safari-gold);
      font-size: 0.7rem;
    }

    .no-vehicles {
      text-align: center;
      padding: 2rem;
      color: rgba(255, 255, 255, 0.8);
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border-radius: var(--rounded-lg);
      grid-column: 1 / -1;
    }

    .no-vehicles i {
      font-size: 2rem;
      color: var(--safari-gold);
      margin-bottom: 1rem;
    }

    .loading-spinner {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100px;
      grid-column: 1 / -1;
    }

    .loading-spinner i {
      font-size: 2rem;
      color: var(--safari-gold);
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Vehicle Image Modal */
    .vehicle-image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 3000;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      backdrop-filter: blur(5px);
    }

    .vehicle-image-modal.active {
      display: flex;
    }

    .vehicle-modal-container {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border: 1px solid var(--glass-border);
      border-radius: var(--rounded-xl);
      max-width: 900px;
      width: 100%;
      max-height: 90vh;
      overflow: hidden;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
      animation: modalSlideIn 0.4s ease-out;
      display: flex;
      flex-direction: column;
    }

    .vehicle-modal-header {
      padding: 1.5rem;
      border-bottom: 1px solid var(--glass-border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(0, 0, 0, 0.2);
    }

    .vehicle-modal-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.5rem;
      color: white;
      margin: 0;
    }

    .vehicle-modal-close {
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
    }

    .vehicle-modal-close:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: rotate(90deg);
    }

    .vehicle-modal-body {
      display: flex;
      flex: 1;
      overflow: hidden;
    }

    .vehicle-modal-image-container {
      flex: 1;
      min-height: 400px;
      background: rgba(0, 0, 0, 0.2);
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .vehicle-modal-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .vehicle-modal-no-image {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      width: 100%;
      color: rgba(255, 255, 255, 0.7);
      background-color: rgba(0, 0, 0, 0.2);
    }

    .vehicle-modal-no-image i {
      font-size: 3rem;
      margin-bottom: 1rem;
      color: var(--safari-gold);
    }

    .vehicle-modal-no-image p {
      font-size: 1.2rem;
      text-align: center;
      padding: 0 1rem;
    }

    .vehicle-modal-details {
      width: 300px;
      padding: 1.5rem;
      background: rgba(0, 0, 0, 0.3);
      overflow-y: auto;
      border-left: 1px solid var(--glass-border);
    }

    .vehicle-modal-detail-group {
      margin-bottom: 1.5rem;
    }

    .vehicle-modal-detail-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.1rem;
      color: white;
      margin-bottom: 0.8rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .vehicle-modal-detail-title i {
      color: var(--safari-gold);
    }

    .vehicle-modal-detail-item {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      margin-bottom: 0.6rem;
      font-size: 0.95rem;
      color: rgba(255, 255, 255, 0.8);
    }

    .vehicle-modal-detail-item i {
      color: var(--safari-gold);
      font-size: 0.85rem;
      width: 16px;
      text-align: center;
    }

    .vehicle-modal-features {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }

    .vehicle-modal-feature {
      background: rgba(198, 163, 80, 0.1);
      color: white;
      font-size: 0.8rem;
      padding: 0.3rem 0.6rem;
      border-radius: 20px;
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }

    .vehicle-modal-feature i {
      color: var(--safari-gold);
      font-size: 0.75rem;
    }

    .vehicle-modal-price {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--safari-gold);
      margin-top: 1rem;
      text-align: center;
      padding: 0.8rem;
      background: rgba(198, 163, 80, 0.1);
      border-radius: var(--rounded);
    }

    .vehicle-modal-select {
      margin-top: 1rem;
      width: 100%;
      padding: 0.8rem;
      background: var(--kenya-green);
      color: white;
      border: none;
      border-radius: var(--rounded);
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      border: 1px solid var(--kenya-green);
    }

    .vehicle-modal-select:hover {
      background: var(--safari-gold);
      color: var(--kenya-black);
      border-color: var(--safari-gold);
    }

    /* Footer Styles */
    .footer {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border-top: 1px solid var(--glass-border);
      color: white;
      padding: 2rem 0;
      margin-top: auto;
      position: relative;
      width: 100%;
    }

    .footer::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: var(--safari-gold);
    }

    .footer .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
      position: relative;
      z-index: 1;
      width: 100%;
    }

    .footer p {
      color: rgba(255, 255, 255, 0.8);
      font-size: clamp(0.9rem, 1.5vw, 1rem);
    }

    .social-links {
      display: flex;
      gap: 1rem;
    }

    .social-link {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 2.5rem;
      height: 2.5rem;
      border-radius: 50%;
      background: var(--kenya-green);
      color: white;
      transition: var(--transition);
      border: 1px solid var(--kenya-green);
    }

    .social-link:hover {
      background: var(--safari-gold);
      color: var(--kenya-black);
      transform: translateY(-3px);
    }

    /* WhatsApp Modal */
    .whatsapp-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }

    .whatsapp-modal.active {
      display: flex;
    }

    .whatsapp-container {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border: 1px solid var(--glass-border);
      border-radius: var(--rounded-xl);
      width: 100%;
      max-width: 500px;
      max-height: 90vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
      animation: modalSlideIn 0.3s ease-out;
    }

    @keyframes modalSlideIn {
      from {
        transform: translateY(50px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    .whatsapp-header {
      background: var(--whatsapp);
      color: white;
      padding: 1rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .whatsapp-header h3 {
      font-family: 'Montserrat', sans-serif;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .whatsapp-close {
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
    }

    .whatsapp-close:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    .whatsapp-body {
      padding: 1.5rem;
      overflow-y: auto;
      flex: 1;
      background: rgba(255, 255, 255, 0.9);
    }

    .whatsapp-message {
      background: #f0f2f5;
      padding: 1rem;
      border-radius: var(--rounded);
      margin-bottom: 1rem;
      white-space: pre-wrap;
      font-family: inherit;
      font-size: 0.95rem;
      line-height: 1.5;
      color: var(--dark);
    }

    .whatsapp-actions {
      padding: 1rem;
      border-top: 1px solid var(--glass-border);
      display: flex;
      gap: 1rem;
      background: rgba(255, 255, 255, 0.9);
    }

    .whatsapp-btn {
      flex: 1;
      padding: 0.75rem;
      border-radius: var(--rounded);
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .whatsapp-send {
      background: var(--whatsapp);
      color: white;
    }

    .whatsapp-send:hover {
      background: var(--whatsapp-dark);
    }

    .whatsapp-cancel {
      background: #f0f2f5;
      color: #333;
    }

    .whatsapp-cancel:hover {
      background: #e4e6eb;
    }

    /* Success Modal */
    .success-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }

    .success-modal.active {
      display: flex;
    }

    .success-container {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border: 1px solid var(--glass-border);
      border-radius: var(--rounded-xl);
      width: 100%;
      max-width: 500px;
      padding: 2rem;
      text-align: center;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
      animation: modalSlideIn 0.3s ease-out;
    }

    .success-icon {
      font-size: 3rem;
      color: var(--safari-green);
      margin-bottom: 1rem;
    }

    .success-container h3 {
      font-family: 'Montserrat', sans-serif;
      font-size: 1.5rem;
      color: white;
      margin-bottom: 1rem;
    }

    .success-container p {
      color: rgba(255, 255, 255, 0.9);
      margin-bottom: 1.5rem;
    }

    .success-btn {
      background: var(--kenya-green);
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: var(--rounded);
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      border: 1px solid var(--kenya-green);
    }

    .success-btn:hover {
      background: var(--safari-gold);
      color: var(--kenya-black);
      border-color: var(--safari-gold);
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
      .container {
        padding: 0 1rem;
      }

      .nav {
        position: fixed;
        top: 75px;
        left: 0;
        width: 100%;
        background: var(--glass-bg);
        backdrop-filter: blur(var(--glass-blur));
        -webkit-backdrop-filter: blur(var(--glass-blur));
        border: 1px solid var(--glass-border);
        flex-direction: column;
        gap: 0;
        padding: 1rem 0;
        box-shadow: var(--glass-shadow);
        border-radius: 0 0 1rem 1rem;
        transform: translateY(-150%);
        transition: var(--transition);
        z-index: 99;
        max-height: calc(100vh - 75px);
        overflow-y: auto;
      }

      .nav.active {
        transform: translateY(0);
      }

      .nav a {
        width: 100%;
        padding: 1rem 1.5rem;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        align-items: center;
      }

      .nav a:hover {
        background: rgba(198, 163, 80, 0.1);
      }

      .nav a::after {
        display: none;
      }

      .nav .btn {
        margin: 1rem;
        width: calc(100% - 2rem);
        justify-content: center;
      }

      .mobile-menu-btn {
        display: flex;
      }

      .booking-container {
        padding: 0 1rem;
      }

      .booking-illustration {
        padding: 1.5rem;
      }

      .form-container {
        padding: 1.5rem;
      }

      .form-grid {
        grid-template-columns: 1fr;
      }

      .vehicle-grid {
        grid-template-columns: 1fr;
      }

      .btn {
        padding: 0.875rem 1.5rem;
        font-size: 1rem;
      }

      .vehicle-modal-body {
        flex-direction: column;
      }

      .vehicle-modal-details {
        width: 100%;
        border-left: none;
        border-top: 1px solid var(--glass-border);
      }
    }

    /* Tablet Responsive */
    @media (min-width: 769px) and (max-width: 1024px) {
      .booking-container {
        padding: 0 1.5rem;
      }

      .form-grid {
        grid-template-columns: repeat(2, 1fr);
      }

      .vehicle-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .booking-illustration,
    .form-container {
      animation: fadeInUp 0.8s ease-out;
    }

    .form-container {
      animation-delay: 0.2s;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="container">
      <div class="brand">
        <a href="/" aria-label="Home">
          <i class="fas fa-globe-africa" aria-hidden="true"></i>
          Airport & Destinations
        </a>
      </div>
      <nav class="nav" id="mainNav" aria-label="Main Navigation">
        <a href="/" aria-label="Home">
          <i class="fas fa-home"></i>
          Home
        </a>
        <a class="btn" href="/tours-and-safaris/" aria-label="Tours & Safaris">
          <i class="fas fa-binoculars"></i>
          Tours & Safaris
        </a>
        <a href="/nairobi-airport-transfers-and-taxis/" aria-label="Airport Transfers">
          <i class="fas fa-plane-arrival"></i>
          Airport Transfers
        </a>
        <a href="/about/" aria-label="About">
          <i class="fas fa-info-circle"></i>
          About
        </a>
        <a href="/contact/" aria-label="Contact">
          <i class="fas fa-envelope"></i>
          Contact
        </a>
      </nav>
      <button class="mobile-menu-btn" id="menuToggle" aria-label="Toggle menu" aria-expanded="false" aria-controls="mainNav">
        <i class="fas fa-bars" aria-hidden="true"></i>
      </button>
    </div>
  </header>

  <!-- Main -->
  <main>
    <div class="booking-container">
      <div class="booking-header">
        <h1>Book Your Kenyan Adventure</h1>
        <p>Select your service, choose your vehicle, and we'll handle the rest with our instant WhatsApp booking system</p>
      </div>

      <div class="booking-content">
        <div class="booking-illustration" data-aos="fade-right">
          <i class="fab fa-whatsapp"></i>
          <h2>Instant WhatsApp Booking</h2>
          <p>Submit your booking details and we'll contact you immediately via WhatsApp to confirm your reservation.</p>
        </div>

        <div class="form-container" data-aos="fade-left">
          <h2><i class="fas fa-calendar-check"></i> Book Your Service</h2>
          <form id="bookingForm">
            <!-- Trip Details Section -->
            <div class="form-section">
              <h3 class="form-section-title"><i class="fas fa-route"></i> Trip Details</h3>
              <div class="form-grid">
                <div class="form-group">
                  <label for="service">Service Type</label>
                  <select id="service" class="form-control" required>
                    <option value="">Select a service</option>
                    <option value="airport-transfer">Airport Transfer</option>
                    <option value="excursion">Excursion</option>
                    <option value="tour-safari">Tour / Safari</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="date">Date</label>
                  <input type="date" id="date" class="form-control" required>
                </div>
                <div class="form-group">
                  <label for="time">Time</label>
                  <input type="time" id="time" class="form-control" required>
                </div>
                <div class="form-group">
                  <label for="passengers">Passengers</label>
                  <input type="number" id="passengers" class="form-control" min="1" value="1" required>
                </div>
                <div class="form-group">
                  <label for="pickup">Pickup Location</label>
                  <input type="text" id="pickup" class="form-control" placeholder="JKIA T1A, Hotel, etc." required>
                </div>
                <div class="form-group">
                  <label for="dropoff">Dropoff Location</label>
                  <input type="text" id="dropoff" class="form-control" placeholder="Westlands, CBD, etc." required>
                </div>
              </div>
            </div>

            <!-- Vehicle Selection Section -->
            <div class="form-section">
              <h3 class="form-section-title"><i class="fas fa-car"></i> Select Vehicle</h3>
              <div id="vehicleGrid" class="vehicle-grid">
                <div class="loading-spinner">
                  <i class="fas fa-spinner"></i>
                </div>
              </div>
              <input type="hidden" id="selectedVehicle" name="selectedVehicle" required>
            </div>

            <!-- Personal Details Section -->
            <div class="form-section">
              <h3 class="form-section-title"><i class="fas fa-user"></i> Personal Details</h3>
              <div class="form-grid">
                <div class="form-group">
                  <label for="name">Full Name</label>
                  <input type="text" id="name" class="form-control" placeholder="Your full name" required>
                </div>
                <div class="form-group">
                  <label for="phone">Phone Number</label>
                  <input type="tel" id="phone" class="form-control" placeholder="+254 7XX XXX XXX" required>
                </div>
                <div class="form-group" style="grid-column: 1 / -1;">
                  <label for="notes">Special Requests</label>
                  <textarea id="notes" class="form-control" placeholder="Flight number, special requirements, etc."></textarea>
                </div>
              </div>
            </div>

            <button type="submit" class="btn" id="whatsappBookingBtn">
              <i class="fab fa-whatsapp"></i> Book via WhatsApp
            </button>

            <div class="form-note">
              <i class="fas fa-info-circle"></i>
              <div>
                <p><strong>Note:</strong> No payment required on this website. We'll contact you via WhatsApp to confirm your booking and discuss payment options.</p>
                <p><strong>Benefits:</strong> Instant confirmation, no hidden fees, 24/7 customer support.</p>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <p>© 2025 Airport & Destinations • DEV BRYTEC LTD • Nairobi, Kenya</p>
      <div class="social-links" role="navigation" aria-label="Social media">
        <a href="https://facebook.com" class="social-link" target="_blank" aria-label="Facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
        <a href="https://twitter.com" class="social-link" target="_blank" aria-label="Twitter">
          <i class="fab fa-twitter"></i>
        </a>
        <a href="https://instagram.com" class="social-link" target="_blank" aria-label="Instagram">
          <i class="fab fa-instagram"></i>
        </a>
        <a href="https://wa.me/254759234580" class="social-link" target="_blank" aria-label="WhatsApp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </div>
    </div>
  </footer>

 <!-- Vehicle Image Modal -->
<div id="vehicleImageModal" class="vehicle-image-modal">
  <div class="vehicle-modal-container">
    <div class="vehicle-modal-header">
      <h3 class="vehicle-modal-title" id="vehicleModalTitle">Vehicle Details</h3>
      <button class="vehicle-modal-close" id="vehicleModalClose">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="vehicle-modal-body">
      <div class="vehicle-modal-image-container" id="vehicleModalImageContainer">
        <img id="vehicleModalImage" class="vehicle-modal-image" style="display: none;" alt="Vehicle Image">
        <div id="vehicleModalNoImage" class="vehicle-modal-no-image">
          <i class="fas fa-image"></i>
          <p>No Photo Available</p>
        </div>
      </div>

      <div class="vehicle-modal-details">
        <div class="vehicle-modal-detail-group">
          <h4 class="vehicle-modal-detail-title"><i class="fas fa-info-circle"></i> Basic Information</h4>
          <div class="vehicle-modal-detail-item">
            <i class="fas fa-car"></i>
            <span id="vehicleModalMakeModel">Vehicle Name</span>
          </div>
          <div class="vehicle-modal-detail-item">
            <i class="fas fa-calendar"></i>
            <span id="vehicleModalYear">Year</span>
          </div>
          <div class="vehicle-modal-detail-item">
            <i class="fas fa-palette"></i>
            <span id="vehicleModalColor">Color</span>
          </div>
          <div class="vehicle-modal-detail-item">
            <i class="fas fa-gas-pump"></i>
            <span id="vehicleModalFuel">Fuel Type</span>
          </div>
        </div>

        <div class="vehicle-modal-detail-group">
          <h4 class="vehicle-modal-detail-title"><i class="fas fa-users"></i> Capacity & Type</h4>
          <div class="vehicle-modal-detail-item">
            <i class="fas fa-users"></i>
            <span id="vehicleModalCapacity">Capacity</span>
          </div>
          <div class="vehicle-modal-detail-item">
            <i class="fas fa-car-side"></i>
            <span id="vehicleModalType">Vehicle Type</span>
          </div>
        </div>

        <div class="vehicle-modal-detail-group">
          <h4 class="vehicle-modal-detail-title"><i class="fas fa-star"></i> Features</h4>
          <div id="vehicleModalFeatures" class="vehicle-modal-features">
            <span class="vehicle-modal-feature">Standard</span>
          </div>
        </div>

        <div class="vehicle-modal-price" id="vehicleModalPrice">
          Contact for pricing
        </div>

        <button class="vehicle-modal-select" id="vehicleModalSelectBtn">Select This Vehicle</button>
      </div>
    </div>
  </div>
</div>


  <!-- WhatsApp Modal -->
  <div id="whatsappModal" class="whatsapp-modal">
    <div class="whatsapp-container">
      <div class="whatsapp-header">
        <h3><i class="fab fa-whatsapp"></i> Send Booking via WhatsApp</h3>
        <button class="whatsapp-close" id="whatsappClose">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="whatsapp-body">
        <div id="whatsappMessage" class="whatsapp-message"></div>
      </div>
      <div class="whatsapp-actions">
        <button class="whatsapp-btn whatsapp-cancel" id="whatsappCancel">
          <i class="fas fa-times-circle"></i> Cancel
        </button>
        <button class="whatsapp-btn whatsapp-send" id="whatsappSend">
          <i class="fab fa-whatsapp"></i> Send to WhatsApp
        </button>
      </div>
    </div>
  </div>

  <!-- Success Modal -->
  <div id="successModal" class="success-modal">
    <div class="success-container">
      <i class="fas fa-check-circle success-icon"></i>
      <h3>Booking Submitted Successfully!</h3>
      <p>We've received your booking request and will contact you shortly via WhatsApp to confirm your reservation.</p>
      <button class="success-btn" id="successClose">Close</button>
    </div>
  </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.1/aos.js"></script>
<script>
/**
 * Clean modular JavaScript for vehicles, menu, modal, and WhatsApp booking.
 * - Uses defensive checks so missing DOM elements won't throw errors.
 * - Avoids unsafe innerHTML for user-sourced content.
 * - Reads whatsapp target number from body dataset: <body data-whatsapp-number="254759234580">
 */

document.addEventListener('DOMContentLoaded', () => {
  /* ============================
     Config & Helpers
     ============================ */
  const config = {
    aos: { duration: 800, easing: 'ease-in-out', once: true },
    apiVehiclesUrl: '/api/vehicles/',
    // read whatsapp destination from meta tag
    whatsappTargetNumber: document.querySelector('meta[data-whatsapp-number]')?.getAttribute('data-whatsapp-number') || '254759234580',
    defaultVehicleImageWidth: 800,
  };

  // Safe element getter
  const $ = (id) => document.getElementById(id);

  // Escapes text by using textContent when inserting into elements
  function setText(el, text) {
    if (!el) return;
    el.textContent = text ?? '';
  }

  // Create an element with optional classes and attributes
  function el(tag, { classes = [], attrs = {}, text = null } = {}) {
    const e = document.createElement(tag);
    if (classes.length) e.classList.add(...classes);
    Object.keys(attrs).forEach(k => e.setAttribute(k, attrs[k]));
    if (text !== null) e.textContent = text;
    return e;
  }

  // Return whether filename looks like an image
  function isImageFilename(name) {
    return typeof name === 'string' && name.match(/\.(png|jpe?g|gif|webp|svg)$/i);
  }

  // Provide fallback image based on vehicle type
  function getFallbackImage(vehicleType) {
    const type = (vehicleType || '').toLowerCase();
    if (type.includes('suv') || type.includes('jeep')) {
      return `https://images.unsplash.com/photo-1554224712-d8560f709cbe?auto=format&fit=crop&w=${config.defaultVehicleImageWidth}&q=80`;
    } else if (type.includes('sedan') || type.includes('saloon')) {
      return `https://images.unsplash.com/photo-1554224713-b3739b9b37a0?auto=format&fit=crop&w=${config.defaultVehicleImageWidth}&q=80`;
    } else if (type.includes('van') || type.includes('minibus')) {
      return `https://images.unsplash.com/photo-1570165888111-03c4d0d1d4a4?auto=format&fit=crop&w=${config.defaultVehicleImageWidth}&q=80`;
    } else if (type.includes('luxury') || type.includes('premium')) {
      return `https://images.unsplash.com/photo-1552519507-da3b142c6e3d?auto=format&fit=crop&w=${config.defaultVehicleImageWidth}&q=80`;
    } else if (type.includes('bus')) {
      return `https://images.unsplash.com/photo-1583121274602-3e2820c69888?auto=format&fit=crop&w=${config.defaultVehicleImageWidth}&q=80`;
    } else if (type.includes('electric') || type.includes('hybrid')) {
      return `https://images.unsplash.com/photo-1593941707882-a5bba6f5b4b0?auto=format&fit=crop&w=${config.defaultVehicleImageWidth}&q=80`;
    } else {
      return `https://images.unsplash.com/photo-1549399542-7e244f5c2f4d?auto=format&fit=crop&w=${config.defaultVehicleImageWidth}&q=80`;
    }
  }

  // Robust image handler - gets the best possible image URL from a vehicle object
  function getVehicleImageUrl(vehicle) {
    // Default fallback image
    let imageUrl = getFallbackImage(vehicle.vehicle_type);

    // Try different possible image properties in order of preference
    if (vehicle.image) {
      if (typeof vehicle.image === 'string') {
        imageUrl = vehicle.image;
      } else if (vehicle.image.url) {
        imageUrl = vehicle.image.url;
      }
    } else if (vehicle.image_url) {
      imageUrl = vehicle.image_url;
    } else if (vehicle.photo) {
      if (typeof vehicle.photo === 'string') {
        imageUrl = vehicle.photo;
      } else if (vehicle.photo.url) {
        imageUrl = vehicle.photo.url;
      }
    } else if (vehicle.get_image_src) {
      imageUrl = vehicle.get_image_src;
    }

    return imageUrl;
  }

  // Robust image error handler: set fallback if original fails
  function handleImageError(img, vehicleType) {
    if (!img) return;
    img.onerror = null; // prevent loop
    img.src = getFallbackImage(vehicleType);
  }

  /* ============================
     AOS Init
     ============================ */
  if (window.AOS) {
    AOS.init(config.aos);
  }

  /* ============================
     Mobile menu toggle
     ============================ */
  (function setupMenuToggle() {
    const menuToggle = $('menuToggle');
    const mainNav = $('mainNav');

    if (!menuToggle || !mainNav) return;

    // Ensure aria attributes exist
    menuToggle.setAttribute('aria-expanded', 'false');
    menuToggle.setAttribute('aria-controls', 'mainNav');

    function setIcon(isOpen) {
      const icon = menuToggle.querySelector('i');
      if (!icon) return;
      icon.classList.toggle('fa-bars', !isOpen);
      icon.classList.toggle('fa-times', isOpen);
    }

    menuToggle.addEventListener('click', (e) => {
      e.stopPropagation();
      const isOpen = mainNav.classList.toggle('active');
      menuToggle.setAttribute('aria-expanded', String(isOpen));
      setIcon(isOpen);
    });

    document.addEventListener('click', (e) => {
      if (!mainNav.classList.contains('active')) return;
      if (!mainNav.contains(e.target) && !menuToggle.contains(e.target)) {
        mainNav.classList.remove('active');
        menuToggle.setAttribute('aria-expanded', 'false');
        setIcon(false);
      }
    });
  })();

  /* ============================
     Vehicle Modal (accessible)
     ============================ */
  const modal = {
    container: $('vehicleImageModal'),
    closeBtn: $('vehicleModalClose'),
    selectBtn: $('vehicleModalSelectBtn'),
    title: $('vehicleModalTitle'),
    image: $('vehicleModalImage'),
    noImagePlaceholder: $('vehicleModalNoImage'),
    makeModel: $('vehicleModalMakeModel'),
    year: $('vehicleModalYear'),
    color: $('vehicleModalColor'),
    fuel: $('vehicleModalFuel'),
    capacity: $('vehicleModalCapacity'),
    type: $('vehicleModalType'),
    price: $('vehicleModalPrice'),
    featuresContainer: $('vehicleModalFeatures'),
    currentVehicleId: null,
  };

  (function setupModal() {
    if (!modal.container) return;

    // Accessibility attributes
    modal.container.setAttribute('role', 'dialog');
    modal.container.setAttribute('aria-modal', 'true');
    modal.container.setAttribute('aria-hidden', 'true');

    function open(vehicle) {
      if (!vehicle) return;
      modal.currentVehicleId = vehicle.id ?? null;

      setText(modal.title, `${vehicle.make || ''} ${vehicle.model || ''}`);
      setText(modal.makeModel, `${vehicle.make || ''} ${vehicle.model || ''}`);
      setText(modal.year, vehicle.year ?? '');
      setText(modal.color, vehicle.color || 'Standard');
      setText(modal.fuel, vehicle.fuel_type || '');
      setText(modal.capacity, (vehicle.capacity ? `${vehicle.capacity} passengers` : ''));
      setText(modal.type, vehicle.vehicle_type || '');
      setText(modal.price, vehicle.price_per_day ?? 'Contact for pricing');

      // Features
      if (modal.featuresContainer) {
        modal.featuresContainer.innerHTML = ''; // safe because we create elements below

        const features = Array.isArray(vehicle.features) && vehicle.features.length ? vehicle.features : ['Standard'];
        features.forEach(f => {
          const node = el('span', { classes: ['vehicle-modal-feature'] });
          node.insertAdjacentHTML('afterbegin', '<i class="fas fa-check" aria-hidden="true"></i> ');
          node.appendChild(document.createTextNode(String(f)));
          modal.featuresContainer.appendChild(node);
        });

        if (Array.isArray(vehicle.accessibility_features) && vehicle.accessibility_features.length) {
          vehicle.accessibility_features.forEach(f => {
            const node = el('span', { classes: ['vehicle-modal-feature'] });
            node.insertAdjacentHTML('afterbegin', '<i class="fas fa-wheelchair" aria-hidden="true"></i> ');
            node.appendChild(document.createTextNode(String(f)));
            modal.featuresContainer.appendChild(node);
          });
        }
      }

      // Image handling - use our robust image URL function
      const vehicleImageUrl = getVehicleImageUrl(vehicle);

      if (modal.image) {
        modal.image.src = vehicleImageUrl;
        modal.image.style.display = 'block';
        modal.image.alt = `${vehicle.make || ''} ${vehicle.model || ''}`.trim();
        modal.noImagePlaceholder && (modal.noImagePlaceholder.style.display = 'none');
        modal.image.onerror = () => handleImageError(modal.image, vehicle.vehicle_type);
      }

      modal.container.classList.add('active');
      modal.container.setAttribute('aria-hidden', 'false');
      // focus trap / focus management could be added here
    }

    function close() {
      modal.container.classList.remove('active');
      modal.container.setAttribute('aria-hidden', 'true');
      modal.currentVehicleId = null;
    }

    // Attach close events
    modal.closeBtn && modal.closeBtn.addEventListener('click', close);
    modal.container && modal.container.addEventListener('click', (e) => {
      // close modal when clicking on backdrop (assuming backdrop has same container)
      if (e.target === modal.container) close();
    });

    modal.selectBtn && modal.selectBtn.addEventListener('click', () => {
      if (!modal.currentVehicleId) return;
      const selectedInput = $('selectedVehicle');
      if (selectedInput) selectedInput.value = modal.currentVehicleId;

      // visually mark selected vehicle on the page
      document.querySelectorAll('.vehicle-card').forEach(card => {
        card.classList.toggle('selected', card.dataset.vehicleId === String(modal.currentVehicleId));
      });

      close();
    });

    // Expose open function
    modal.open = open;
    modal.close = close;
  })();

  /* ============================
     Vehicle Grid: Fetch + Render
     ============================ */
  async function loadVehicles() {
    const vehicleGrid = $('vehicleGrid');
    if (!vehicleGrid) return;

    // Loading UI
    vehicleGrid.innerHTML = '';
    const spinner = el('div', { classes: ['loading-spinner'] });
    spinner.innerHTML = '<i class="fas fa-spinner" aria-hidden="true"></i>';
    vehicleGrid.appendChild(spinner);

    try {
      // Try multiple possible endpoints
      const endpoints = [
        '/api/vehicles/',
        '/vehicles/api/',
        '/api/vehicle/',
        '/vehicles/',
        // Add your Django app name if different
        '/yourapp/api/vehicles/',
        '/yourapp/vehicles/api/'
      ];

      let vehicles = null;
      let response = null;

      for (const endpoint of endpoints) {
        try {
          console.log(`Trying to fetch vehicles from: ${endpoint}`);
          response = await fetch(endpoint, { headers: { 'Accept': 'application/json' }});

          if (response.ok) {
            vehicles = await response.json();
            console.log(`Successfully fetched vehicles from ${endpoint}`);
            break;
          }
        } catch (error) {
          console.error(`Error fetching from ${endpoint}:`, error);
        }
      }

      if (!vehicles) {
        throw new Error('Could not fetch vehicles from any endpoint');
      }

      // Handle different response formats
      if (vehicles && vehicles.data && Array.isArray(vehicles.data)) {
        vehicles = vehicles.data;
      } else if (vehicles && vehicles.results && Array.isArray(vehicles.results)) {
        vehicles = vehicles.results;
      } else if (vehicles && vehicles.vehicles && Array.isArray(vehicles.vehicles)) {
        vehicles = vehicles.vehicles;
      } else if (!Array.isArray(vehicles)) {
        vehicles = [vehicles];
      }

      window.vehicles = vehicles; // convenient global reference

      // Clear grid
      vehicleGrid.innerHTML = '';

      const activeVehicles = Array.isArray(vehicles) ? vehicles.filter(v => v.is_active !== false) : [];

      if (activeVehicles.length === 0) {
        const no = el('div', { classes: ['no-vehicles'] });
        no.innerHTML = '<i class="fas fa-car-side" aria-hidden="true"></i><p>No vehicles available at the moment. Please check back later.</p>';
        vehicleGrid.appendChild(no);
        return;
      }

      // Build cards
      activeVehicles.forEach(vehicle => {
        const card = el('article', { classes: ['vehicle-card'], attrs: { 'data-vehicle-id': String(vehicle.id || '') } });

        // IMAGE CONTAINER
        const imgContainer = el('div', { classes: ['vehicle-image-container'] });
        const img = el('img', { classes: ['vehicle-image'], attrs: { alt: `${vehicle.make || ''} ${vehicle.model || ''}`.trim() } });

        // Use our robust image URL function
        img.src = getVehicleImageUrl(vehicle);
        img.addEventListener('error', () => handleImageError(img, vehicle.vehicle_type));
        imgContainer.appendChild(img);

        // CONTENT
        const content = el('div', { classes: ['vehicle-content'] });

        const header = el('div', { classes: ['vehicle-header'] });
        const titleWrap = el('div');
        const title = el('h3', { classes: ['vehicle-title'], text: `${vehicle.make || ''} ${vehicle.model || ''}`.trim() });
        const year = el('div', { classes: ['vehicle-year'], text: vehicle.year ? String(vehicle.year) : '' });
        titleWrap.appendChild(title);
        titleWrap.appendChild(year);

        const price = el('div', { classes: ['vehicle-price'], text: vehicle.price_per_day || 'Contact for pricing' });

        header.appendChild(titleWrap);
        header.appendChild(price);

        const details = el('div', { classes: ['vehicle-details'] });
        const color = el('div', { classes: ['vehicle-detail'] });
        color.innerHTML = '<i class="fas fa-palette" aria-hidden="true"></i> ';
        color.appendChild(document.createTextNode(vehicle.color || 'Standard'));
        const cap = el('div', { classes: ['vehicle-detail'] });
        cap.innerHTML = '<i class="fas fa-users" aria-hidden="true"></i> ';
        cap.appendChild(document.createTextNode(`${vehicle.capacity ?? '-'} passengers`));
        const vtype = el('div', { classes: ['vehicle-detail'] });
        vtype.innerHTML = '<i class="fas fa-car" aria-hidden="true"></i> ';
        vtype.appendChild(document.createTextNode(vehicle.vehicle_type || '-'));
        const fuel = el('div', { classes: ['vehicle-detail'] });
        fuel.innerHTML = '<i class="fas fa-gas-pump" aria-hidden="true"></i> ';
        fuel.appendChild(document.createTextNode(vehicle.fuel_type || '-'));

        details.appendChild(color);
        details.appendChild(cap);
        details.appendChild(vtype);
        details.appendChild(fuel);

        // features
        const featuresWrap = el('div', { classes: ['vehicle-features'] });
        const features = Array.isArray(vehicle.features) && vehicle.features.length ? vehicle.features : ['Standard'];
        features.forEach(f => {
          const node = el('span', { classes: ['vehicle-feature'] });
          node.insertAdjacentHTML('afterbegin', '<i class="fas fa-check" aria-hidden="true"></i> ');
          node.appendChild(document.createTextNode(String(f)));
          featuresWrap.appendChild(node);
        });

        // accessibility features
        if (Array.isArray(vehicle.accessibility_features) && vehicle.accessibility_features.length) {
          vehicle.accessibility_features.forEach(f => {
            const node = el('span', { classes: ['vehicle-feature'] });
            node.insertAdjacentHTML('afterbegin', '<i class="fas fa-wheelchair" aria-hidden="true"></i> ');
            node.appendChild(document.createTextNode(String(f)));
            featuresWrap.appendChild(node);
          });
        }

        content.appendChild(header);
        content.appendChild(details);
        content.appendChild(featuresWrap);

        card.appendChild(imgContainer);
        card.appendChild(content);

        // click -> select + open modal
        card.addEventListener('click', () => {
          // visual selection
          document.querySelectorAll('.vehicle-card').forEach(c => c.classList.remove('selected'));
          card.classList.add('selected');

          // set selected hidden input
          const selected = $('selectedVehicle');
          if (selected) selected.value = String(vehicle.id || '');

          // open modal with this vehicle
          modal.open(vehicle);
        });

        vehicleGrid.appendChild(card);
      });
    } catch (err) {
      console.error('Error loading vehicles:', err);
      vehicleGrid.innerHTML = '';
      const errorNode = el('div', { classes: ['no-vehicles'] });
      errorNode.innerHTML = `<i class="fas fa-exclamation-triangle" aria-hidden="true"></i><p>Error loading vehicles: ${String(err.message)}. Please try again later.</p>`;
      vehicleGrid.appendChild(errorNode);
    }
  }

  /* ============================
     Booking Form & WhatsApp Flow
     ============================ */
  (function setupBooking() {
    const bookingForm = $('bookingForm');
    const whatsappModal = $('whatsappModal');
    const whatsappMessageEl = $('whatsappMessage');
    const whatsappClose = $('whatsappClose');
    const whatsappCancel = $('whatsappCancel');
    const whatsappSend = $('whatsappSend');
    const successModal = $('successModal');
    const successClose = $('successClose');
    const whatsappBookingBtn = $('whatsappBookingBtn');

    if (!bookingForm || !whatsappModal || !whatsappMessageEl || !whatsappSend || !whatsappBookingBtn) {
      // Nothing to setup if required DOM missing
      return;
    }

    let whatsappUrl = '';

    function normalizePhone(phone) {
      if (!phone) return '';
      phone = phone.trim();
      // remove spaces, dashes, parentheses
      phone = phone.replace(/[\s()-]/g, '');
      if (phone.startsWith('+')) return phone;
      if (phone.startsWith('0')) return '+254' + phone.slice(1);
      if (phone.startsWith('7')) return '+254' + phone;
      // fallback: return as is without plus
      return phone;
    }

    function buildMessage(formData, selectedVehicle) {
      const safe = (v) => v == null ? '' : String(v);
      const features = Array.isArray(selectedVehicle?.features) && selectedVehicle.features.length
        ? selectedVehicle.features.join(', ')
        : 'Standard';

      const accessibility = Array.isArray(selectedVehicle?.accessibility_features) && selectedVehicle.accessibility_features.length
        ? `*Accessibility Features:* ${selectedVehicle.accessibility_features.join(', ')}\n`
        : '';

      return (
        `*New Booking Request*\n\n` +
        `*Service:* ${safe(formData.service)}\n` +
        `*Date:* ${safe(formData.date)}\n` +
        `*Time:* ${safe(formData.time)}\n` +
        `*Passengers:* ${safe(formData.passengers)}\n` +
        `*From:* ${safe(formData.pickup)}\n` +
        `*To:* ${safe(formData.dropoff)}\n` +
        `*Name:* ${safe(formData.name)}\n` +
        `*Phone:* ${safe(formData.phone)}\n` +
        `*Selected Vehicle:* ${safe(selectedVehicle?.make)} ${safe(selectedVehicle?.model)} (${safe(selectedVehicle?.year)})\n` +
        `*Vehicle Type:* ${safe(selectedVehicle?.vehicle_type)}\n` +
        `*License Plate:* ${safe(selectedVehicle?.license_plate)}\n` +
        `*Capacity:* ${safe(selectedVehicle?.capacity)} passengers\n` +
        `*Features:* ${features}\n` +
        `${accessibility}` +
        (formData.notes ? `*Notes:* ${safe(formData.notes)}\n` : '')
      );
    }

    whatsappBookingBtn.addEventListener('click', (ev) => {
      ev.preventDefault();

      const selectedVehicleId = $('selectedVehicle')?.value;
      if (!selectedVehicleId) {
        alert('Please select a vehicle for your booking.');
        return;
      }

      const formData = {
        service: $('service')?.value ?? '',
        date: $('date')?.value ?? '',
        time: $('time')?.value ?? '',
        passengers: $('passengers')?.value ?? '',
        pickup: $('pickup')?.value ?? '',
        dropoff: $('dropoff')?.value ?? '',
        name: $('name')?.value ?? '',
        phone: $('phone')?.value ?? '',
        notes: $('notes')?.value ?? '',
        vehicleId: selectedVehicleId,
      };

      // basic validation
      if (!formData.service || !formData.date || !formData.time || !formData.passengers || !formData.pickup || !formData.dropoff || !formData.name || !formData.phone) {
        alert('Please fill in all required fields.');
        return;
      }

      // normalize phone for message display, not the wa.me target
      formData.phone = normalizePhone(formData.phone);

      const selectedVehicle = (Array.isArray(window.vehicles) ? window.vehicles.find(v => String(v.id) === String(formData.vehicleId)) : null);
      const message = buildMessage(formData, selectedVehicle || {});
      whatsappUrl = `https://wa.me/${config.whatsappTargetNumber}?text=${encodeURIComponent(message)}`;

      // show message in modal
      whatsappMessageEl.textContent = message;
      whatsappModal.classList.add('active');
    });

    function closeWhatsappModal() {
      whatsappModal.classList.remove('active');
    }

    whatsappClose && whatsappClose.addEventListener('click', closeWhatsappModal);
    whatsappCancel && whatsappCancel.addEventListener('click', closeWhatsappModal);

    whatsappSend.addEventListener('click', () => {
      if (!whatsappUrl) return;
      window.open(whatsappUrl, '_blank', 'noopener');
      closeWhatsappModal();

      // show success modal and reset
      successModal && successModal.classList.add('active');
      bookingForm.reset();
      $('selectedVehicle') && ($('selectedVehicle').value = '');
      document.querySelectorAll('.vehicle-card').forEach(card => card.classList.remove('selected'));
    });

    successClose && successClose.addEventListener('click', () => {
      successModal.classList.remove('active');
    });
  })();

  // Kick things off
  loadVehicles();
});
</script>


</body>
</html>